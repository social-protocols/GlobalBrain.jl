(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const f of a)if(f.type==="childList")for(const h of f.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&s(h)}).observe(document,{childList:!0,subtree:!0});function i(a){const f={};return a.integrity&&(f.integrity=a.integrity),a.referrerPolicy&&(f.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?f.credentials="include":a.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function s(a){if(a.ep)return;a.ep=!0;const f=i(a);fetch(a.href,f)}})();const so="/GlobalBrain.jl/assets/sim-CGPCkifa.db";function ao(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function uo(t){if(t.__esModule)return t;var r=t.default;if(typeof r=="function"){var i=function s(){return this instanceof s?Reflect.construct(r,arguments,this.constructor):r.apply(this,arguments)};i.prototype=r.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(t).forEach(function(s){var a=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(i,s,a.get?a:{enumerable:!0,get:function(){return t[s]}})}),i}var Gr={exports:{}};const lo={},fo=Object.freeze(Object.defineProperty({__proto__:null,default:lo},Symbol.toStringTag,{value:"Module"})),on=uo(fo);(function(t,r){var i=void 0,s=function(a){return i||(i=new Promise(function(f,h){var d=typeof a<"u"?a:{},p=d.onAbort;d.onAbort=function(e){h(new Error(e)),p&&p(e)},d.postRun=d.postRun||[],d.postRun.push(function(){f(d)}),t=void 0;var l;l||(l=typeof d<"u"?d:{}),l.onRuntimeInitialized=function(){function e(m,g){switch(typeof g){case"boolean":io(m,g?1:0);break;case"number":eo(m,g);break;case"string":no(m,g,-1,-1);break;case"object":if(g===null)wr(m);else if(g.length!=null){var A=we(g,ve);ro(m,A,g.length,-1),xe(A)}else Ae(m,"Wrong API use : tried to return a value of an unknown type ("+g+").",-1);break;default:wr(m)}}function n(m,g){for(var A=[],M=0;M<m;M+=1){var P=ft(g+4*M,"i32"),H=Ki(P);if(H===1||H===2)P=to(P);else if(H===3)P=ji(P);else if(H===4){H=P,P=Qi(H),H=Zi(H);for(var nt=new Uint8Array(P),tt=0;tt<P;tt+=1)nt[tt]=W[H+tt];P=nt}else P=null;A.push(P)}return A}function o(m,g){this.La=m,this.db=g,this.Ja=1,this.fb=[]}function u(m,g){if(this.db=g,g=kt(m)+1,this.Ya=be(g),this.Ya===null)throw Error("Unable to allocate memory for the SQL string");Ot(m,$,this.Ya,g),this.eb=this.Ya,this.Ua=this.ib=null}function c(m){if(this.filename="dbfile_"+(4294967295*Math.random()>>>0),m!=null){var g=this.filename,A="/",M=g;if(A&&(A=typeof A=="string"?A:Ut(A),M=g?ct(A+"/"+g):A),g=Gn(!0,!0),M=he(M,(g!==void 0?g:438)&4095|32768,0),m){if(typeof m=="string"){A=Array(m.length);for(var P=0,H=m.length;P<H;++P)A[P]=m.charCodeAt(P);m=A}pe(M,g|146),A=Pt(M,577),ir(A,m,0,m.length,0),Qe(A),pe(M,g)}}this.handleError(I(this.filename,y)),this.db=ft(y,"i32"),br(this.db),this.Za={},this.Na={}}var y=yt(4),w=l.cwrap,I=w("sqlite3_open","number",["string","number"]),L=w("sqlite3_close_v2","number",["number"]),O=w("sqlite3_exec","number",["number","string","number","number","number"]),z=w("sqlite3_changes","number",["number"]),V=w("sqlite3_prepare_v2","number",["number","string","number","number","number"]),pr=w("sqlite3_sql","string",["number"]),Pi=w("sqlite3_normalized_sql","string",["number"]),mr=w("sqlite3_prepare_v2","number",["number","number","number","number","number"]),Ti=w("sqlite3_bind_text","number",["number","number","number","number","number"]),_r=w("sqlite3_bind_blob","number",["number","number","number","number","number"]),Li=w("sqlite3_bind_double","number",["number","number","number"]),Ci=w("sqlite3_bind_int","number",["number","number","number"]),$i=w("sqlite3_bind_parameter_index","number",["number","string"]),Hi=w("sqlite3_step","number",["number"]),Di=w("sqlite3_errmsg","string",["number"]),Fi=w("sqlite3_column_count","number",["number"]),Gi=w("sqlite3_data_count","number",["number"]),Bi=w("sqlite3_column_double","number",["number","number"]),yr=w("sqlite3_column_text","string",["number","number"]),zi=w("sqlite3_column_blob","number",["number","number"]),Ui=w("sqlite3_column_bytes","number",["number","number"]),Wi=w("sqlite3_column_type","number",["number","number"]),Vi=w("sqlite3_column_name","string",["number","number"]),Xi=w("sqlite3_reset","number",["number"]),Ji=w("sqlite3_clear_bindings","number",["number"]),Yi=w("sqlite3_finalize","number",["number"]),vr=w("sqlite3_create_function_v2","number","number string number number number number number number number".split(" ")),Ki=w("sqlite3_value_type","number",["number"]),Qi=w("sqlite3_value_bytes","number",["number"]),ji=w("sqlite3_value_text","string",["number"]),Zi=w("sqlite3_value_blob","number",["number"]),to=w("sqlite3_value_double","number",["number"]),eo=w("sqlite3_result_double","",["number","number"]),wr=w("sqlite3_result_null","",["number"]),no=w("sqlite3_result_text","",["number","string","number","number"]),ro=w("sqlite3_result_blob","",["number","number","number","number"]),io=w("sqlite3_result_int","",["number","number"]),Ae=w("sqlite3_result_error","",["number","string","number"]),gr=w("sqlite3_aggregate_context","number",["number","number"]),br=w("RegisterExtensionFunctions","number",["number"]);o.prototype.bind=function(m){if(!this.La)throw"Statement closed";return this.reset(),Array.isArray(m)?this.wb(m):m!=null&&typeof m=="object"?this.xb(m):!0},o.prototype.step=function(){if(!this.La)throw"Statement closed";this.Ja=1;var m=Hi(this.La);switch(m){case 100:return!0;case 101:return!1;default:throw this.db.handleError(m)}},o.prototype.rb=function(m){return m==null&&(m=this.Ja,this.Ja+=1),Bi(this.La,m)},o.prototype.Ab=function(m){if(m==null&&(m=this.Ja,this.Ja+=1),m=yr(this.La,m),typeof BigInt!="function")throw Error("BigInt is not supported");return BigInt(m)},o.prototype.Bb=function(m){return m==null&&(m=this.Ja,this.Ja+=1),yr(this.La,m)},o.prototype.getBlob=function(m){m==null&&(m=this.Ja,this.Ja+=1);var g=Ui(this.La,m);m=zi(this.La,m);for(var A=new Uint8Array(g),M=0;M<g;M+=1)A[M]=W[m+M];return A},o.prototype.get=function(m,g){g=g||{},m!=null&&this.bind(m)&&this.step(),m=[];for(var A=Gi(this.La),M=0;M<A;M+=1)switch(Wi(this.La,M)){case 1:var P=g.useBigInt?this.Ab(M):this.rb(M);m.push(P);break;case 2:m.push(this.rb(M));break;case 3:m.push(this.Bb(M));break;case 4:m.push(this.getBlob(M));break;default:m.push(null)}return m},o.prototype.getColumnNames=function(){for(var m=[],g=Fi(this.La),A=0;A<g;A+=1)m.push(Vi(this.La,A));return m},o.prototype.getAsObject=function(m,g){m=this.get(m,g),g=this.getColumnNames();for(var A={},M=0;M<g.length;M+=1)A[g[M]]=m[M];return A},o.prototype.getSQL=function(){return pr(this.La)},o.prototype.getNormalizedSQL=function(){return Pi(this.La)},o.prototype.run=function(m){return m!=null&&this.bind(m),this.step(),this.reset()},o.prototype.nb=function(m,g){g==null&&(g=this.Ja,this.Ja+=1),m=$n(m);var A=we(m,ve);this.fb.push(A),this.db.handleError(Ti(this.La,g,A,m.length-1,0))},o.prototype.vb=function(m,g){g==null&&(g=this.Ja,this.Ja+=1);var A=we(m,ve);this.fb.push(A),this.db.handleError(_r(this.La,g,A,m.length,0))},o.prototype.mb=function(m,g){g==null&&(g=this.Ja,this.Ja+=1),this.db.handleError((m===(m|0)?Ci:Li)(this.La,g,m))},o.prototype.yb=function(m){m==null&&(m=this.Ja,this.Ja+=1),_r(this.La,m,0,0,0)},o.prototype.ob=function(m,g){switch(g==null&&(g=this.Ja,this.Ja+=1),typeof m){case"string":this.nb(m,g);return;case"number":this.mb(m,g);return;case"bigint":this.nb(m.toString(),g);return;case"boolean":this.mb(m+0,g);return;case"object":if(m===null){this.yb(g);return}if(m.length!=null){this.vb(m,g);return}}throw"Wrong API use : tried to bind a value of an unknown type ("+m+")."},o.prototype.xb=function(m){var g=this;return Object.keys(m).forEach(function(A){var M=$i(g.La,A);M!==0&&g.ob(m[A],M)}),!0},o.prototype.wb=function(m){for(var g=0;g<m.length;g+=1)this.ob(m[g],g+1);return!0},o.prototype.reset=function(){return this.freemem(),Ji(this.La)===0&&Xi(this.La)===0},o.prototype.freemem=function(){for(var m;(m=this.fb.pop())!==void 0;)xe(m)},o.prototype.free=function(){this.freemem();var m=Yi(this.La)===0;return delete this.db.Za[this.La],this.La=0,m},u.prototype.next=function(){if(this.Ya===null)return{done:!0};if(this.Ua!==null&&(this.Ua.free(),this.Ua=null),!this.db.db)throw this.gb(),Error("Database closed");var m=Yt(),g=yt(4);Bt(y),Bt(g);try{this.db.handleError(mr(this.db.db,this.eb,-1,y,g)),this.eb=ft(g,"i32");var A=ft(y,"i32");return A===0?(this.gb(),{done:!0}):(this.Ua=new o(A,this.db),this.db.Za[A]=this.Ua,{value:this.Ua,done:!1})}catch(M){throw this.ib=Ue(this.eb),this.gb(),M}finally{Kt(m)}},u.prototype.gb=function(){xe(this.Ya),this.Ya=null},u.prototype.getRemainingSQL=function(){return this.ib!==null?this.ib:Ue(this.eb)},typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(u.prototype[Symbol.iterator]=function(){return this}),c.prototype.run=function(m,g){if(!this.db)throw"Database closed";if(g){m=this.prepare(m,g);try{m.step()}finally{m.free()}}else this.handleError(O(this.db,m,0,0,y));return this},c.prototype.exec=function(m,g,A){if(!this.db)throw"Database closed";var M=Yt(),P=null;try{var H=en(m),nt=yt(4);for(m=[];ft(H,"i8")!==0;){Bt(y),Bt(nt),this.handleError(mr(this.db,H,-1,y,nt));var tt=ft(y,"i32");if(H=ft(nt,"i32"),tt!==0){var Q=null;for(P=new o(tt,this),g!=null&&P.bind(g);P.step();)Q===null&&(Q={columns:P.getColumnNames(),values:[]},m.push(Q)),Q.values.push(P.get(null,A));P.free()}}return m}catch(rt){throw P&&P.free(),rt}finally{Kt(M)}},c.prototype.each=function(m,g,A,M,P){typeof g=="function"&&(M=A,A=g,g=void 0),m=this.prepare(m,g);try{for(;m.step();)A(m.getAsObject(null,P))}finally{m.free()}if(typeof M=="function")return M()},c.prototype.prepare=function(m,g){if(Bt(y),this.handleError(V(this.db,m,-1,y,0)),m=ft(y,"i32"),m===0)throw"Nothing to prepare";var A=new o(m,this);return g!=null&&A.bind(g),this.Za[m]=A},c.prototype.iterateStatements=function(m){return new u(m,this)},c.prototype.export=function(){Object.values(this.Za).forEach(function(g){g.free()}),Object.values(this.Na).forEach(Tt),this.Na={},this.handleError(L(this.db));var m=Ni(this.filename);return this.handleError(I(this.filename,y)),this.db=ft(y,"i32"),br(this.db),m},c.prototype.close=function(){this.db!==null&&(Object.values(this.Za).forEach(function(m){m.free()}),Object.values(this.Na).forEach(Tt),this.Na={},this.handleError(L(this.db)),jn("/"+this.filename),this.db=null)},c.prototype.handleError=function(m){if(m===0)return null;throw m=Di(this.db),Error(m)},c.prototype.getRowsModified=function(){return z(this.db)},c.prototype.create_function=function(m,g){Object.prototype.hasOwnProperty.call(this.Na,m)&&(Tt(this.Na[m]),delete this.Na[m]);var A=ge(function(M,P,H){P=n(P,H);try{var nt=g.apply(null,P)}catch(tt){Ae(M,tt,-1);return}e(M,nt)},"viii");return this.Na[m]=A,this.handleError(vr(this.db,m,g.length,1,0,A,0,0,0)),this},c.prototype.create_aggregate=function(m,g){var A=g.init||function(){return null},M=g.finalize||function(Q){return Q},P=g.step;if(!P)throw"An aggregate function must have a step function in "+m;var H={};Object.hasOwnProperty.call(this.Na,m)&&(Tt(this.Na[m]),delete this.Na[m]),g=m+"__finalize",Object.hasOwnProperty.call(this.Na,g)&&(Tt(this.Na[g]),delete this.Na[g]);var nt=ge(function(Q,rt,rn){var At=gr(Q,1);Object.hasOwnProperty.call(H,At)||(H[At]=A()),rt=n(rt,rn),rt=[H[At]].concat(rt);try{H[At]=P.apply(null,rt)}catch(oo){delete H[At],Ae(Q,oo,-1)}},"viii"),tt=ge(function(Q){var rt=gr(Q,1);try{var rn=M(H[rt])}catch(At){delete H[rt],Ae(Q,At,-1);return}e(Q,rn),delete H[rt]},"vi");return this.Na[m]=nt,this.Na[g]=tt,this.handleError(vr(this.db,m,P.length-1,1,0,0,nt,tt,0)),this},l.Database=c};var v=Object.assign({},l),_="./this.program",b=typeof window=="object",E=typeof importScripts=="function",T=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",N="",C,mt,U;if(T){var X=on,Nt=on;N=E?Nt.dirname(N)+"/":__dirname+"/",C=(e,n)=>(e=le(e)?new URL(e):Nt.normalize(e),X.readFileSync(e,n?void 0:"utf8")),U=e=>(e=C(e,!0),e.buffer||(e=new Uint8Array(e)),e),mt=(e,n,o,u=!0)=>{e=le(e)?new URL(e):Nt.normalize(e),X.readFile(e,u?void 0:"utf8",(c,y)=>{c?o(c):n(u?y.buffer:y)})},!l.thisProgram&&1<process.argv.length&&(_=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),t.exports=l,l.inspect=()=>"[Emscripten Module object]"}else(b||E)&&(E?N=self.location.href:typeof document<"u"&&document.currentScript&&(N=document.currentScript.src),N=N.indexOf("blob:")!==0?N.substr(0,N.replace(/[?#].*/,"").lastIndexOf("/")+1):"",C=e=>{var n=new XMLHttpRequest;return n.open("GET",e,!1),n.send(null),n.responseText},E&&(U=e=>{var n=new XMLHttpRequest;return n.open("GET",e,!1),n.responseType="arraybuffer",n.send(null),new Uint8Array(n.response)}),mt=(e,n,o)=>{var u=new XMLHttpRequest;u.open("GET",e,!0),u.responseType="arraybuffer",u.onload=()=>{u.status==200||u.status==0&&u.response?n(u.response):o()},u.onerror=o,u.send(null)});var Ht=l.print||console.log.bind(console),wt=l.printErr||console.error.bind(console);Object.assign(l,v),v=null,l.thisProgram&&(_=l.thisProgram);var Dt;l.wasmBinary&&(Dt=l.wasmBinary),typeof WebAssembly!="object"&&lt("no native wasm support detected");var ue,Sn=!1,W,$,Ft,k,F,Ge,Be;function qn(){var e=ue.buffer;l.HEAP8=W=new Int8Array(e),l.HEAP16=Ft=new Int16Array(e),l.HEAPU8=$=new Uint8Array(e),l.HEAPU16=new Uint16Array(e),l.HEAP32=k=new Int32Array(e),l.HEAPU32=F=new Uint32Array(e),l.HEAPF32=Ge=new Float32Array(e),l.HEAPF64=Be=new Float64Array(e)}var In=[],Nn=[],Mn=[];function yi(){var e=l.preRun.shift();In.unshift(e)}var gt=0,Gt=null;function lt(e){var n;throw(n=l.onAbort)==null||n.call(l,e),e="Aborted("+e+")",wt(e),Sn=!0,new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info.")}var kn=e=>e.startsWith("data:application/octet-stream;base64,"),le=e=>e.startsWith("file://"),Mt;if(Mt="sql-wasm.wasm",!kn(Mt)){var On=Mt;Mt=l.locateFile?l.locateFile(On,N):N+On}function Rn(e){if(e==Mt&&Dt)return new Uint8Array(Dt);if(U)return U(e);throw"both async and sync fetching of the wasm failed"}function vi(e){if(!Dt&&(b||E)){if(typeof fetch=="function"&&!le(e))return fetch(e,{credentials:"same-origin"}).then(n=>{if(!n.ok)throw"failed to load wasm binary file at '"+e+"'";return n.arrayBuffer()}).catch(()=>Rn(e));if(mt)return new Promise((n,o)=>{mt(e,u=>n(new Uint8Array(u)),o)})}return Promise.resolve().then(()=>Rn(e))}function Pn(e,n,o){return vi(e).then(u=>WebAssembly.instantiate(u,n)).then(u=>u).then(o,u=>{wt(`failed to asynchronously prepare wasm: ${u}`),lt(u)})}function wi(e,n){var o=Mt;Dt||typeof WebAssembly.instantiateStreaming!="function"||kn(o)||le(o)||T||typeof fetch!="function"?Pn(o,e,n):fetch(o,{credentials:"same-origin"}).then(u=>WebAssembly.instantiateStreaming(u,e).then(n,function(c){return wt(`wasm streaming compile failed: ${c}`),wt("falling back to ArrayBuffer instantiation"),Pn(o,e,n)}))}var q,G,ze=e=>{for(;0<e.length;)e.shift()(l)};function ft(e,n="i8"){switch(n.endsWith("*")&&(n="*"),n){case"i1":return W[e>>0];case"i8":return W[e>>0];case"i16":return Ft[e>>1];case"i32":return k[e>>2];case"i64":lt("to do getValue(i64) use WASM_BIGINT");case"float":return Ge[e>>2];case"double":return Be[e>>3];case"*":return F[e>>2];default:lt(`invalid type for getValue: ${n}`)}}function Bt(e){var n="i32";switch(n.endsWith("*")&&(n="*"),n){case"i1":W[e>>0]=0;break;case"i8":W[e>>0]=0;break;case"i16":Ft[e>>1]=0;break;case"i32":k[e>>2]=0;break;case"i64":lt("to do setValue(i64) use WASM_BIGINT");case"float":Ge[e>>2]=0;break;case"double":Be[e>>3]=0;break;case"*":F[e>>2]=0;break;default:lt(`invalid type for setValue: ${n}`)}}var Tn=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,B=(e,n,o)=>{var u=n+o;for(o=n;e[o]&&!(o>=u);)++o;if(16<o-n&&e.buffer&&Tn)return Tn.decode(e.subarray(n,o));for(u="";n<o;){var c=e[n++];if(c&128){var y=e[n++]&63;if((c&224)==192)u+=String.fromCharCode((c&31)<<6|y);else{var w=e[n++]&63;c=(c&240)==224?(c&15)<<12|y<<6|w:(c&7)<<18|y<<12|w<<6|e[n++]&63,65536>c?u+=String.fromCharCode(c):(c-=65536,u+=String.fromCharCode(55296|c>>10,56320|c&1023))}}else u+=String.fromCharCode(c)}return u},Ue=(e,n)=>e?B($,e,n):"",Ln=(e,n)=>{for(var o=0,u=e.length-1;0<=u;u--){var c=e[u];c==="."?e.splice(u,1):c===".."?(e.splice(u,1),o++):o&&(e.splice(u,1),o--)}if(n)for(;o;o--)e.unshift("..");return e},ct=e=>{var n=e.charAt(0)==="/",o=e.substr(-1)==="/";return(e=Ln(e.split("/").filter(u=>!!u),!n).join("/"))||n||(e="."),e&&o&&(e+="/"),(n?"/":"")+e},gi=e=>{var n=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(e).slice(1);return e=n[0],n=n[1],!e&&!n?".":(n&&(n=n.substr(0,n.length-1)),e+n)},fe=e=>{if(e==="/")return"/";e=ct(e),e=e.replace(/\/$/,"");var n=e.lastIndexOf("/");return n===-1?e:e.substr(n+1)},bi=()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return o=>crypto.getRandomValues(o);if(T)try{var e=on;if(e.randomFillSync)return o=>e.randomFillSync(o);var n=e.randomBytes;return o=>(o.set(n(o.byteLength)),o)}catch{}lt("initRandomDevice")},Cn=e=>(Cn=bi())(e);function ce(){for(var e="",n=!1,o=arguments.length-1;-1<=o&&!n;o--){if(n=0<=o?arguments[o]:"/",typeof n!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!n)return"";e=n+"/"+e,n=n.charAt(0)==="/"}return e=Ln(e.split("/").filter(u=>!!u),!n).join("/"),(n?"/":"")+e||"."}var We=[],kt=e=>{for(var n=0,o=0;o<e.length;++o){var u=e.charCodeAt(o);127>=u?n++:2047>=u?n+=2:55296<=u&&57343>=u?(n+=4,++o):n+=3}return n},Ot=(e,n,o,u)=>{if(!(0<u))return 0;var c=o;u=o+u-1;for(var y=0;y<e.length;++y){var w=e.charCodeAt(y);if(55296<=w&&57343>=w){var I=e.charCodeAt(++y);w=65536+((w&1023)<<10)|I&1023}if(127>=w){if(o>=u)break;n[o++]=w}else{if(2047>=w){if(o+1>=u)break;n[o++]=192|w>>6}else{if(65535>=w){if(o+2>=u)break;n[o++]=224|w>>12}else{if(o+3>=u)break;n[o++]=240|w>>18,n[o++]=128|w>>12&63}n[o++]=128|w>>6&63}n[o++]=128|w&63}}return n[o]=0,o-c};function $n(e,n){var o=Array(kt(e)+1);return e=Ot(e,o,0,o.length),n&&(o.length=e),o}var Hn=[];function Dn(e,n){Hn[e]={input:[],output:[],Xa:n},Ye(e,xi)}var xi={open(e){var n=Hn[e.node.rdev];if(!n)throw new x(43);e.tty=n,e.seekable=!1},close(e){e.tty.Xa.fsync(e.tty)},fsync(e){e.tty.Xa.fsync(e.tty)},read(e,n,o,u){if(!e.tty||!e.tty.Xa.sb)throw new x(60);for(var c=0,y=0;y<u;y++){try{var w=e.tty.Xa.sb(e.tty)}catch{throw new x(29)}if(w===void 0&&c===0)throw new x(6);if(w==null)break;c++,n[o+y]=w}return c&&(e.node.timestamp=Date.now()),c},write(e,n,o,u){if(!e.tty||!e.tty.Xa.jb)throw new x(60);try{for(var c=0;c<u;c++)e.tty.Xa.jb(e.tty,n[o+c])}catch{throw new x(29)}return u&&(e.node.timestamp=Date.now()),c}},Ei={sb(){t:{if(!We.length){var e=null;if(T){var n=Buffer.alloc(256),o=0,u=process.stdin.fd;try{o=X.readSync(u,n)}catch(c){if(c.toString().includes("EOF"))o=0;else throw c}0<o?e=n.slice(0,o).toString("utf-8"):e=null}else typeof window<"u"&&typeof window.prompt=="function"?(e=window.prompt("Input: "),e!==null&&(e+=`
`)):typeof readline=="function"&&(e=readline(),e!==null&&(e+=`
`));if(!e){e=null;break t}We=$n(e,!0)}e=We.shift()}return e},jb(e,n){n===null||n===10?(Ht(B(e.output,0)),e.output=[]):n!=0&&e.output.push(n)},fsync(e){e.output&&0<e.output.length&&(Ht(B(e.output,0)),e.output=[])},Mb(){return{Ib:25856,Kb:5,Hb:191,Jb:35387,Gb:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},Nb(){return 0},Ob(){return[24,80]}},Ai={jb(e,n){n===null||n===10?(wt(B(e.output,0)),e.output=[]):n!=0&&e.output.push(n)},fsync(e){e.output&&0<e.output.length&&(wt(B(e.output,0)),e.output=[])}};function Fn(e,n){var o=e.Ia?e.Ia.length:0;o>=n||(n=Math.max(n,o*(1048576>o?2:1.125)>>>0),o!=0&&(n=Math.max(n,256)),o=e.Ia,e.Ia=new Uint8Array(n),0<e.Ma&&e.Ia.set(o.subarray(0,e.Ma),0))}var R={Qa:null,Ra(){return R.createNode(null,"/",16895,0)},createNode(e,n,o,u){if((o&61440)===24576||(o&61440)===4096)throw new x(63);return R.Qa||(R.Qa={dir:{node:{Pa:R.Ga.Pa,Oa:R.Ga.Oa,lookup:R.Ga.lookup,ab:R.Ga.ab,rename:R.Ga.rename,unlink:R.Ga.unlink,rmdir:R.Ga.rmdir,readdir:R.Ga.readdir,symlink:R.Ga.symlink},stream:{Ta:R.Ha.Ta}},file:{node:{Pa:R.Ga.Pa,Oa:R.Ga.Oa},stream:{Ta:R.Ha.Ta,read:R.Ha.read,write:R.Ha.write,lb:R.Ha.lb,bb:R.Ha.bb,cb:R.Ha.cb}},link:{node:{Pa:R.Ga.Pa,Oa:R.Ga.Oa,readlink:R.Ga.readlink},stream:{}},pb:{node:{Pa:R.Ga.Pa,Oa:R.Ga.Oa},stream:Ii}}),o=Wn(e,n,o,u),Z(o.mode)?(o.Ga=R.Qa.dir.node,o.Ha=R.Qa.dir.stream,o.Ia={}):(o.mode&61440)===32768?(o.Ga=R.Qa.file.node,o.Ha=R.Qa.file.stream,o.Ma=0,o.Ia=null):(o.mode&61440)===40960?(o.Ga=R.Qa.link.node,o.Ha=R.Qa.link.stream):(o.mode&61440)===8192&&(o.Ga=R.Qa.pb.node,o.Ha=R.Qa.pb.stream),o.timestamp=Date.now(),e&&(e.Ia[n]=o,e.timestamp=o.timestamp),o},Lb(e){return e.Ia?e.Ia.subarray?e.Ia.subarray(0,e.Ma):new Uint8Array(e.Ia):new Uint8Array(0)},Ga:{Pa(e){var n={};return n.dev=(e.mode&61440)===8192?e.id:1,n.ino=e.id,n.mode=e.mode,n.nlink=1,n.uid=0,n.gid=0,n.rdev=e.rdev,Z(e.mode)?n.size=4096:(e.mode&61440)===32768?n.size=e.Ma:(e.mode&61440)===40960?n.size=e.link.length:n.size=0,n.atime=new Date(e.timestamp),n.mtime=new Date(e.timestamp),n.ctime=new Date(e.timestamp),n.zb=4096,n.blocks=Math.ceil(n.size/n.zb),n},Oa(e,n){if(n.mode!==void 0&&(e.mode=n.mode),n.timestamp!==void 0&&(e.timestamp=n.timestamp),n.size!==void 0&&(n=n.size,e.Ma!=n))if(n==0)e.Ia=null,e.Ma=0;else{var o=e.Ia;e.Ia=new Uint8Array(n),o&&e.Ia.set(o.subarray(0,Math.min(n,e.Ma))),e.Ma=n}},lookup(){throw Xe[44]},ab(e,n,o,u){return R.createNode(e,n,o,u)},rename(e,n,o){if(Z(e.mode)){try{var u=bt(n,o)}catch{}if(u)for(var c in u.Ia)throw new x(55)}delete e.parent.Ia[e.name],e.parent.timestamp=Date.now(),e.name=o,n.Ia[o]=e,n.timestamp=e.parent.timestamp,e.parent=n},unlink(e,n){delete e.Ia[n],e.timestamp=Date.now()},rmdir(e,n){var o=bt(e,n),u;for(u in o.Ia)throw new x(55);delete e.Ia[n],e.timestamp=Date.now()},readdir(e){var n=[".",".."],o;for(o of Object.keys(e.Ia))n.push(o);return n},symlink(e,n,o){return e=R.createNode(e,n,41471,0),e.link=o,e},readlink(e){if((e.mode&61440)!==40960)throw new x(28);return e.link}},Ha:{read(e,n,o,u,c){var y=e.node.Ia;if(c>=e.node.Ma)return 0;if(e=Math.min(e.node.Ma-c,u),8<e&&y.subarray)n.set(y.subarray(c,c+e),o);else for(u=0;u<e;u++)n[o+u]=y[c+u];return e},write(e,n,o,u,c,y){if(n.buffer===W.buffer&&(y=!1),!u)return 0;if(e=e.node,e.timestamp=Date.now(),n.subarray&&(!e.Ia||e.Ia.subarray)){if(y)return e.Ia=n.subarray(o,o+u),e.Ma=u;if(e.Ma===0&&c===0)return e.Ia=n.slice(o,o+u),e.Ma=u;if(c+u<=e.Ma)return e.Ia.set(n.subarray(o,o+u),c),u}if(Fn(e,c+u),e.Ia.subarray&&n.subarray)e.Ia.set(n.subarray(o,o+u),c);else for(y=0;y<u;y++)e.Ia[c+y]=n[o+y];return e.Ma=Math.max(e.Ma,c+u),u},Ta(e,n,o){if(o===1?n+=e.position:o===2&&(e.node.mode&61440)===32768&&(n+=e.node.Ma),0>n)throw new x(28);return n},lb(e,n,o){Fn(e.node,n+o),e.node.Ma=Math.max(e.node.Ma,n+o)},bb(e,n,o,u,c){if((e.node.mode&61440)!==32768)throw new x(43);if(e=e.node.Ia,c&2||e.buffer!==W.buffer){if((0<o||o+n<e.length)&&(e.subarray?e=e.subarray(o,o+n):e=Array.prototype.slice.call(e,o,o+n)),o=!0,n=65536*Math.ceil(n/65536),(c=hr(65536,n))?($.fill(0,c,c+n),n=c):n=0,!n)throw new x(48);W.set(e,n)}else o=!1,n=e.byteOffset;return{Db:n,ub:o}},cb(e,n,o,u){return R.Ha.write(e,n,0,u,o,!1),0}}},Gn=(e,n)=>{var o=0;return e&&(o|=365),n&&(o|=146),o},Ve=null,Bn={},zt=[],Si=1,_t=null,zn=!0,x=null,Xe={};function Y(e,n={}){if(e=ce(e),!e)return{path:"",node:null};if(n=Object.assign({qb:!0,kb:0},n),8<n.kb)throw new x(32);e=e.split("/").filter(w=>!!w);for(var o=Ve,u="/",c=0;c<e.length;c++){var y=c===e.length-1;if(y&&n.parent)break;if(o=bt(o,e[c]),u=ct(u+"/"+e[c]),o.Va&&(!y||y&&n.qb)&&(o=o.Va.root),!y||n.Sa){for(y=0;(o.mode&61440)===40960;)if(o=Zn(u),u=ce(gi(u),o),o=Y(u,{kb:n.kb+1}).node,40<y++)throw new x(32)}}return{path:u,node:o}}function Ut(e){for(var n;;){if(e===e.parent)return e=e.Ra.tb,n?e[e.length-1]!=="/"?`${e}/${n}`:e+n:e;n=n?`${e.name}/${n}`:e.name,e=e.parent}}function Je(e,n){for(var o=0,u=0;u<n.length;u++)o=(o<<5)-o+n.charCodeAt(u)|0;return(e+o>>>0)%_t.length}function Un(e){var n=Je(e.parent.id,e.name);if(_t[n]===e)_t[n]=e.Wa;else for(n=_t[n];n;){if(n.Wa===e){n.Wa=e.Wa;break}n=n.Wa}}function bt(e,n){var o;if(o=(o=Rt(e,"x"))?o:e.Ga.lookup?0:2)throw new x(o,e);for(o=_t[Je(e.id,n)];o;o=o.Wa){var u=o.name;if(o.parent.id===e.id&&u===n)return o}return e.Ga.lookup(e,n)}function Wn(e,n,o,u){return e=new fr(e,n,o,u),n=Je(e.parent.id,e.name),e.Wa=_t[n],_t[n]=e}function Z(e){return(e&61440)===16384}function Vn(e){var n=["r","w","rw"][e&3];return e&512&&(n+="w"),n}function Rt(e,n){if(zn)return 0;if(!n.includes("r")||e.mode&292){if(n.includes("w")&&!(e.mode&146)||n.includes("x")&&!(e.mode&73))return 2}else return 2;return 0}function Xn(e,n){try{return bt(e,n),20}catch{}return Rt(e,"wx")}function Jn(e,n,o){try{var u=bt(e,n)}catch(c){return c.Ka}if(e=Rt(e,"wx"))return e;if(o){if(!Z(u.mode))return 54;if(u===u.parent||Ut(u)==="/")return 10}else if(Z(u.mode))return 31;return 0}function qi(){for(var e=0;4096>=e;e++)if(!zt[e])return e;throw new x(33)}function J(e){if(e=zt[e],!e)throw new x(8);return e}function Yn(e,n=-1){return Xt||(Xt=function(){this.$a={}},Xt.prototype={},Object.defineProperties(Xt.prototype,{object:{get(){return this.node},set(o){this.node=o}},flags:{get(){return this.$a.flags},set(o){this.$a.flags=o}},position:{get(){return this.$a.position},set(o){this.$a.position=o}}})),e=Object.assign(new Xt,e),n==-1&&(n=qi()),e.fd=n,zt[n]=e}var Ii={open(e){var n,o;e.Ha=Bn[e.node.rdev].Ha,(o=(n=e.Ha).open)==null||o.call(n,e)},Ta(){throw new x(70)}};function Ye(e,n){Bn[e]={Ha:n}}function Kn(e,n){var o=n==="/",u=!n;if(o&&Ve)throw new x(10);if(!o&&!u){var c=Y(n,{qb:!1});if(n=c.path,c=c.node,c.Va)throw new x(10);if(!Z(c.mode))throw new x(54)}n={type:e,Pb:{},tb:n,Cb:[]},e=e.Ra(n),e.Ra=n,n.root=e,o?Ve=e:c&&(c.Va=n,c.Ra&&c.Ra.Cb.push(n))}function he(e,n,o){var u=Y(e,{parent:!0}).node;if(e=fe(e),!e||e==="."||e==="..")throw new x(28);var c=Xn(u,e);if(c)throw new x(c);if(!u.Ga.ab)throw new x(63);return u.Ga.ab(u,e,n,o)}function st(e,n){return he(e,(n!==void 0?n:511)&1023|16384,0)}function de(e,n,o){typeof o>"u"&&(o=n,n=438),he(e,n|8192,o)}function Ke(e,n){if(!ce(e))throw new x(44);var o=Y(n,{parent:!0}).node;if(!o)throw new x(44);n=fe(n);var u=Xn(o,n);if(u)throw new x(u);if(!o.Ga.symlink)throw new x(63);o.Ga.symlink(o,n,e)}function Qn(e){var n=Y(e,{parent:!0}).node;e=fe(e);var o=bt(n,e),u=Jn(n,e,!0);if(u)throw new x(u);if(!n.Ga.rmdir)throw new x(63);if(o.Va)throw new x(10);n.Ga.rmdir(n,e),Un(o)}function jn(e){var n=Y(e,{parent:!0}).node;if(!n)throw new x(44);e=fe(e);var o=bt(n,e),u=Jn(n,e,!1);if(u)throw new x(u);if(!n.Ga.unlink)throw new x(63);if(o.Va)throw new x(10);n.Ga.unlink(n,e),Un(o)}function Zn(e){if(e=Y(e).node,!e)throw new x(44);if(!e.Ga.readlink)throw new x(28);return ce(Ut(e.parent),e.Ga.readlink(e))}function Wt(e,n){if(e=Y(e,{Sa:!n}).node,!e)throw new x(44);if(!e.Ga.Pa)throw new x(63);return e.Ga.Pa(e)}function tr(e){return Wt(e,!0)}function pe(e,n){if(e=typeof e=="string"?Y(e,{Sa:!0}).node:e,!e.Ga.Oa)throw new x(63);e.Ga.Oa(e,{mode:n&4095|e.mode&-4096,timestamp:Date.now()})}function er(e,n){if(0>n)throw new x(28);if(e=typeof e=="string"?Y(e,{Sa:!0}).node:e,!e.Ga.Oa)throw new x(63);if(Z(e.mode))throw new x(31);if((e.mode&61440)!==32768)throw new x(28);var o=Rt(e,"w");if(o)throw new x(o);e.Ga.Oa(e,{size:n,timestamp:Date.now()})}function Pt(e,n,o){if(e==="")throw new x(44);if(typeof n=="string"){var u={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090}[n];if(typeof u>"u")throw Error(`Unknown file open mode: ${n}`);n=u}if(o=n&64?(typeof o>"u"?438:o)&4095|32768:0,typeof e=="object")var c=e;else{e=ct(e);try{c=Y(e,{Sa:!(n&131072)}).node}catch{}}if(u=!1,n&64)if(c){if(n&128)throw new x(20)}else c=he(e,o,0),u=!0;if(!c)throw new x(44);if((c.mode&61440)===8192&&(n&=-513),n&65536&&!Z(c.mode))throw new x(54);if(!u&&(o=c?(c.mode&61440)===40960?32:Z(c.mode)&&(Vn(n)!=="r"||n&512)?31:Rt(c,Vn(n)):44))throw new x(o);return n&512&&!u&&er(c,0),n&=-131713,c=Yn({node:c,path:Ut(c),flags:n,seekable:!0,position:0,Ha:c.Ha,Fb:[],error:!1}),c.Ha.open&&c.Ha.open(c),!l.logReadFiles||n&1||(je||(je={}),e in je||(je[e]=1)),c}function Qe(e){if(e.fd===null)throw new x(8);e.hb&&(e.hb=null);try{e.Ha.close&&e.Ha.close(e)}catch(n){throw n}finally{zt[e.fd]=null}e.fd=null}function nr(e,n,o){if(e.fd===null)throw new x(8);if(!e.seekable||!e.Ha.Ta)throw new x(70);if(o!=0&&o!=1&&o!=2)throw new x(28);e.position=e.Ha.Ta(e,n,o),e.Fb=[]}function rr(e,n,o,u,c){if(0>u||0>c)throw new x(28);if(e.fd===null)throw new x(8);if((e.flags&2097155)===1)throw new x(8);if(Z(e.node.mode))throw new x(31);if(!e.Ha.read)throw new x(28);var y=typeof c<"u";if(!y)c=e.position;else if(!e.seekable)throw new x(70);return n=e.Ha.read(e,n,o,u,c),y||(e.position+=n),n}function ir(e,n,o,u,c){if(0>u||0>c)throw new x(28);if(e.fd===null)throw new x(8);if(!(e.flags&2097155))throw new x(8);if(Z(e.node.mode))throw new x(31);if(!e.Ha.write)throw new x(28);e.seekable&&e.flags&1024&&nr(e,0,2);var y=typeof c<"u";if(!y)c=e.position;else if(!e.seekable)throw new x(70);return n=e.Ha.write(e,n,o,u,c,void 0),y||(e.position+=n),n}function Ni(e){var n,o=Pt(e,o||0);e=Wt(e).size;var u=new Uint8Array(e);return rr(o,u,0,e,0),n=u,Qe(o),n}function or(){x||(x=function(e,n){this.name="ErrnoError",this.node=n,this.Eb=function(o){this.Ka=o},this.Eb(e),this.message="FS error"},x.prototype=Error(),x.prototype.constructor=x,[44].forEach(e=>{Xe[e]=new x(e),Xe[e].stack="<generic error, no stack>"}))}var sr;function Vt(e,n,o){e=ct("/dev/"+e);var u=Gn(!!n,!!o);ar||(ar=64);var c=ar++<<8|0;Ye(c,{open(y){y.seekable=!1},close(){var y;(y=o==null?void 0:o.buffer)!=null&&y.length&&o(10)},read(y,w,I,L){for(var O=0,z=0;z<L;z++){try{var V=n()}catch{throw new x(29)}if(V===void 0&&O===0)throw new x(6);if(V==null)break;O++,w[I+z]=V}return O&&(y.node.timestamp=Date.now()),O},write(y,w,I,L){for(var O=0;O<L;O++)try{o(w[I+O])}catch{throw new x(29)}return L&&(y.node.timestamp=Date.now()),O}}),de(e,u,c)}var ar,D={},Xt,je;function xt(e,n,o){if(n.charAt(0)==="/")return n;if(e=e===-100?"/":J(e).path,n.length==0){if(!o)throw new x(44);return e}return ct(e+"/"+n)}function me(e,n,o){try{var u=e(n)}catch(y){if(y&&y.node&&ct(n)!==ct(Ut(y.node)))return-54;throw y}k[o>>2]=u.dev,k[o+4>>2]=u.mode,F[o+8>>2]=u.nlink,k[o+12>>2]=u.uid,k[o+16>>2]=u.gid,k[o+20>>2]=u.rdev,G=[u.size>>>0,(q=u.size,1<=+Math.abs(q)?0<q?+Math.floor(q/4294967296)>>>0:~~+Math.ceil((q-+(~~q>>>0))/4294967296)>>>0:0)],k[o+24>>2]=G[0],k[o+28>>2]=G[1],k[o+32>>2]=4096,k[o+36>>2]=u.blocks,e=u.atime.getTime(),n=u.mtime.getTime();var c=u.ctime.getTime();return G=[Math.floor(e/1e3)>>>0,(q=Math.floor(e/1e3),1<=+Math.abs(q)?0<q?+Math.floor(q/4294967296)>>>0:~~+Math.ceil((q-+(~~q>>>0))/4294967296)>>>0:0)],k[o+40>>2]=G[0],k[o+44>>2]=G[1],F[o+48>>2]=e%1e3*1e3,G=[Math.floor(n/1e3)>>>0,(q=Math.floor(n/1e3),1<=+Math.abs(q)?0<q?+Math.floor(q/4294967296)>>>0:~~+Math.ceil((q-+(~~q>>>0))/4294967296)>>>0:0)],k[o+56>>2]=G[0],k[o+60>>2]=G[1],F[o+64>>2]=n%1e3*1e3,G=[Math.floor(c/1e3)>>>0,(q=Math.floor(c/1e3),1<=+Math.abs(q)?0<q?+Math.floor(q/4294967296)>>>0:~~+Math.ceil((q-+(~~q>>>0))/4294967296)>>>0:0)],k[o+72>>2]=G[0],k[o+76>>2]=G[1],F[o+80>>2]=c%1e3*1e3,G=[u.ino>>>0,(q=u.ino,1<=+Math.abs(q)?0<q?+Math.floor(q/4294967296)>>>0:~~+Math.ceil((q-+(~~q>>>0))/4294967296)>>>0:0)],k[o+88>>2]=G[0],k[o+92>>2]=G[1],0}var _e=void 0;function ye(){var e=k[+_e>>2];return _e+=4,e}var Jt=(e,n)=>n+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*n:NaN,Mi=[0,31,60,91,121,152,182,213,244,274,305,335],ki=[0,31,59,90,120,151,181,212,243,273,304,334],ur=e=>{var n=kt(e)+1,o=be(n);return o&&Ot(e,$,o,n),o},Ze={},lr=()=>{if(!tn){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:_||"./this.program"},n;for(n in Ze)Ze[n]===void 0?delete e[n]:e[n]=Ze[n];var o=[];for(n in e)o.push(`${n}=${e[n]}`);tn=o}return tn},tn,en=e=>{var n=kt(e)+1,o=yt(n);return Ot(e,$,o,n),o},Oi=(e,n,o,u)=>{var c={string:O=>{var z=0;return O!=null&&O!==0&&(z=en(O)),z},array:O=>{var z=yt(O.length);return W.set(O,z),z}};e=l["_"+e];var y=[],w=0;if(u)for(var I=0;I<u.length;I++){var L=c[o[I]];L?(w===0&&(w=Yt()),y[I]=L(u[I])):y[I]=u[I]}return o=e.apply(null,y),o=function(O){return w!==0&&Kt(w),n==="string"?O?B($,O):"":n==="boolean"?!!O:O}(o)},ve=0,we=(e,n)=>(n=n==1?yt(e.length):be(e.length),e.subarray||e.slice||(e=new Uint8Array(e)),$.set(e,n),n),Et,nn=[],ht,Tt=e=>{Et.delete(ht.get(e)),ht.set(e,null),nn.push(e)},ge=(e,n)=>{if(!Et){Et=new WeakMap;var o=ht.length;if(Et)for(var u=0;u<0+o;u++){var c=ht.get(u);c&&Et.set(c,u)}}if(o=Et.get(e)||0)return o;if(nn.length)o=nn.pop();else{try{ht.grow(1)}catch(I){throw I instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":I}o=ht.length-1}try{ht.set(o,e)}catch(I){if(!(I instanceof TypeError))throw I;if(typeof WebAssembly.Function=="function"){u=WebAssembly.Function,c={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"};for(var y={parameters:[],results:n[0]=="v"?[]:[c[n[0]]]},w=1;w<n.length;++w)y.parameters.push(c[n[w]]);n=new u(y,e)}else{for(u=[1],c=n.slice(0,1),n=n.slice(1),y={i:127,p:127,j:126,f:125,d:124,e:111},u.push(96),w=n.length,128>w?u.push(w):u.push(w%128|128,w>>7),w=0;w<n.length;++w)u.push(y[n[w]]);c=="v"?u.push(0):u.push(1,y[c]),n=[0,97,115,109,1,0,0,0,1],c=u.length,128>c?n.push(c):n.push(c%128|128,c>>7),n.push.apply(n,u),n.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),n=new WebAssembly.Module(new Uint8Array(n)),n=new WebAssembly.Instance(n,{e:{f:e}}).exports.f}ht.set(o,n)}return Et.set(e,o),o};function fr(e,n,o,u){e||(e=this),this.parent=e,this.Ra=e.Ra,this.Va=null,this.id=Si++,this.name=n,this.mode=o,this.Ga={},this.Ha={},this.rdev=u}Object.defineProperties(fr.prototype,{read:{get:function(){return(this.mode&365)===365},set:function(e){e?this.mode|=365:this.mode&=-366}},write:{get:function(){return(this.mode&146)===146},set:function(e){e?this.mode|=146:this.mode&=-147}}}),or(),_t=Array(4096),Kn(R,"/"),st("/tmp"),st("/home"),st("/home/web_user"),function(){st("/dev"),Ye(259,{read:()=>0,write:(u,c,y,w)=>w}),de("/dev/null",259),Dn(1280,Ei),Dn(1536,Ai),de("/dev/tty",1280),de("/dev/tty1",1536);var e=new Uint8Array(1024),n=0,o=()=>(n===0&&(n=Cn(e).byteLength),e[--n]);Vt("random",o),Vt("urandom",o),st("/dev/shm"),st("/dev/shm/tmp")}(),function(){st("/proc");var e=st("/proc/self");st("/proc/self/fd"),Kn({Ra(){var n=Wn(e,"fd",16895,73);return n.Ga={lookup(o,u){var c=J(+u);return o={parent:null,Ra:{tb:"fake"},Ga:{readlink:()=>c.path}},o.parent=o}},n}},"/proc/self/fd")}();var Ri={a:(e,n,o,u)=>{lt(`Assertion failed: ${e?B($,e):""}, at: `+[n?n?B($,n):"":"unknown filename",o,u?u?B($,u):"":"unknown function"])},h:function(e,n){try{return e=e?B($,e):"",pe(e,n),0}catch(o){if(typeof D>"u"||o.name!=="ErrnoError")throw o;return-o.Ka}},H:function(e,n,o){try{if(n=n?B($,n):"",n=xt(e,n),o&-8)return-28;var u=Y(n,{Sa:!0}).node;return u?(e="",o&4&&(e+="r"),o&2&&(e+="w"),o&1&&(e+="x"),e&&Rt(u,e)?-2:0):-44}catch(c){if(typeof D>"u"||c.name!=="ErrnoError")throw c;return-c.Ka}},i:function(e,n){try{var o=J(e);return pe(o.node,n),0}catch(u){if(typeof D>"u"||u.name!=="ErrnoError")throw u;return-u.Ka}},g:function(e){try{var n=J(e).node,o=typeof n=="string"?Y(n,{Sa:!0}).node:n;if(!o.Ga.Oa)throw new x(63);return o.Ga.Oa(o,{timestamp:Date.now()}),0}catch(u){if(typeof D>"u"||u.name!=="ErrnoError")throw u;return-u.Ka}},b:function(e,n,o){_e=o;try{var u=J(e);switch(n){case 0:var c=ye();if(0>c)return-28;for(;zt[c];)c++;return Yn(u,c).fd;case 1:case 2:return 0;case 3:return u.flags;case 4:return c=ye(),u.flags|=c,0;case 5:return c=ye(),Ft[c+0>>1]=2,0;case 6:case 7:return 0;case 16:case 8:return-28;case 9:return k[cr()>>2]=28,-1;default:return-28}}catch(y){if(typeof D>"u"||y.name!=="ErrnoError")throw y;return-y.Ka}},f:function(e,n){try{var o=J(e);return me(Wt,o.path,n)}catch(u){if(typeof D>"u"||u.name!=="ErrnoError")throw u;return-u.Ka}},n:function(e,n,o){n=Jt(n,o);try{if(isNaN(n))return 61;var u=J(e);if(!(u.flags&2097155))throw new x(28);return er(u.node,n),0}catch(c){if(typeof D>"u"||c.name!=="ErrnoError")throw c;return-c.Ka}},C:function(e,n){try{if(n===0)return-28;var o=kt("/")+1;return n<o?-68:(Ot("/",$,e,n),o)}catch(u){if(typeof D>"u"||u.name!=="ErrnoError")throw u;return-u.Ka}},F:function(e,n){try{return e=e?B($,e):"",me(tr,e,n)}catch(o){if(typeof D>"u"||o.name!=="ErrnoError")throw o;return-o.Ka}},z:function(e,n,o){try{return n=n?B($,n):"",n=xt(e,n),n=ct(n),n[n.length-1]==="/"&&(n=n.substr(0,n.length-1)),st(n,o),0}catch(u){if(typeof D>"u"||u.name!=="ErrnoError")throw u;return-u.Ka}},E:function(e,n,o,u){try{n=n?B($,n):"";var c=u&256;return n=xt(e,n,u&4096),me(c?tr:Wt,n,o)}catch(y){if(typeof D>"u"||y.name!=="ErrnoError")throw y;return-y.Ka}},y:function(e,n,o,u){_e=u;try{n=n?B($,n):"",n=xt(e,n);var c=u?ye():0;return Pt(n,o,c).fd}catch(y){if(typeof D>"u"||y.name!=="ErrnoError")throw y;return-y.Ka}},w:function(e,n,o,u){try{if(n=n?B($,n):"",n=xt(e,n),0>=u)return-28;var c=Zn(n),y=Math.min(u,kt(c)),w=W[o+y];return Ot(c,$,o,u+1),W[o+y]=w,y}catch(I){if(typeof D>"u"||I.name!=="ErrnoError")throw I;return-I.Ka}},v:function(e){try{return e=e?B($,e):"",Qn(e),0}catch(n){if(typeof D>"u"||n.name!=="ErrnoError")throw n;return-n.Ka}},G:function(e,n){try{return e=e?B($,e):"",me(Wt,e,n)}catch(o){if(typeof D>"u"||o.name!=="ErrnoError")throw o;return-o.Ka}},r:function(e,n,o){try{return n=n?B($,n):"",n=xt(e,n),o===0?jn(n):o===512?Qn(n):lt("Invalid flags passed to unlinkat"),0}catch(u){if(typeof D>"u"||u.name!=="ErrnoError")throw u;return-u.Ka}},q:function(e,n,o){try{if(n=n?B($,n):"",n=xt(e,n,!0),o){var u=F[o>>2]+4294967296*k[o+4>>2],c=k[o+8>>2];y=1e3*u+c/1e6,o+=16,u=F[o>>2]+4294967296*k[o+4>>2],c=k[o+8>>2],w=1e3*u+c/1e6}else var y=Date.now(),w=y;e=y;var I=Y(n,{Sa:!0}).node;return I.Ga.Oa(I,{timestamp:Math.max(e,w)}),0}catch(L){if(typeof D>"u"||L.name!=="ErrnoError")throw L;return-L.Ka}},l:function(e,n,o){e=new Date(1e3*Jt(e,n)),k[o>>2]=e.getSeconds(),k[o+4>>2]=e.getMinutes(),k[o+8>>2]=e.getHours(),k[o+12>>2]=e.getDate(),k[o+16>>2]=e.getMonth(),k[o+20>>2]=e.getFullYear()-1900,k[o+24>>2]=e.getDay(),n=e.getFullYear(),k[o+28>>2]=(n%4!==0||n%100===0&&n%400!==0?ki:Mi)[e.getMonth()]+e.getDate()-1|0,k[o+36>>2]=-(60*e.getTimezoneOffset()),n=new Date(e.getFullYear(),6,1).getTimezoneOffset();var u=new Date(e.getFullYear(),0,1).getTimezoneOffset();k[o+32>>2]=(n!=u&&e.getTimezoneOffset()==Math.min(u,n))|0},j:function(e,n,o,u,c,y,w,I){c=Jt(c,y);try{if(isNaN(c))return 61;var L=J(u);if(n&2&&!(o&2)&&(L.flags&2097155)!==2)throw new x(2);if((L.flags&2097155)===1)throw new x(2);if(!L.Ha.bb)throw new x(43);var O=L.Ha.bb(L,e,c,n,o),z=O.Db;return k[w>>2]=O.ub,F[I>>2]=z,0}catch(V){if(typeof D>"u"||V.name!=="ErrnoError")throw V;return-V.Ka}},k:function(e,n,o,u,c,y,w){y=Jt(y,w);try{if(isNaN(y))return 61;var I=J(c);if(o&2){if((I.node.mode&61440)!==32768)throw new x(43);if(!(u&2)){var L=$.slice(e,e+n);I.Ha.cb&&I.Ha.cb(I,L,y,n,u)}}}catch(O){if(typeof D>"u"||O.name!=="ErrnoError")throw O;return-O.Ka}},s:(e,n,o)=>{function u(L){return(L=L.toTimeString().match(/\(([A-Za-z ]+)\)$/))?L[1]:"GMT"}var c=new Date().getFullYear(),y=new Date(c,0,1),w=new Date(c,6,1);c=y.getTimezoneOffset();var I=w.getTimezoneOffset();F[e>>2]=60*Math.max(c,I),k[n>>2]=+(c!=I),e=u(y),n=u(w),e=ur(e),n=ur(n),I<c?(F[o>>2]=e,F[o+4>>2]=n):(F[o>>2]=n,F[o+4>>2]=e)},d:()=>Date.now(),t:()=>2147483648,c:()=>performance.now(),o:e=>{var n=$.length;if(e>>>=0,2147483648<e)return!1;for(var o=1;4>=o;o*=2){var u=n*(1+.2/o);u=Math.min(u,e+100663296);var c=Math;u=Math.max(e,u);t:{c=(c.min.call(c,2147483648,u+(65536-u%65536)%65536)-ue.buffer.byteLength+65535)/65536;try{ue.grow(c),qn();var y=1;break t}catch{}y=void 0}if(y)return!0}return!1},A:(e,n)=>{var o=0;return lr().forEach((u,c)=>{var y=n+o;for(c=F[e+4*c>>2]=y,y=0;y<u.length;++y)W[c++>>0]=u.charCodeAt(y);W[c>>0]=0,o+=u.length+1}),0},B:(e,n)=>{var o=lr();F[e>>2]=o.length;var u=0;return o.forEach(c=>u+=c.length+1),F[n>>2]=u,0},e:function(e){try{var n=J(e);return Qe(n),0}catch(o){if(typeof D>"u"||o.name!=="ErrnoError")throw o;return o.Ka}},p:function(e,n){try{var o=J(e);return W[n>>0]=o.tty?2:Z(o.mode)?3:(o.mode&61440)===40960?7:4,Ft[n+2>>1]=0,G=[0,(q=0,1<=+Math.abs(q)?0<q?+Math.floor(q/4294967296)>>>0:~~+Math.ceil((q-+(~~q>>>0))/4294967296)>>>0:0)],k[n+8>>2]=G[0],k[n+12>>2]=G[1],G=[0,(q=0,1<=+Math.abs(q)?0<q?+Math.floor(q/4294967296)>>>0:~~+Math.ceil((q-+(~~q>>>0))/4294967296)>>>0:0)],k[n+16>>2]=G[0],k[n+20>>2]=G[1],0}catch(u){if(typeof D>"u"||u.name!=="ErrnoError")throw u;return u.Ka}},x:function(e,n,o,u){try{t:{var c=J(e);e=n;for(var y,w=n=0;w<o;w++){var I=F[e>>2],L=F[e+4>>2];e+=8;var O=rr(c,W,I,L,y);if(0>O){var z=-1;break t}if(n+=O,O<L)break;typeof y<"u"&&(y+=O)}z=n}return F[u>>2]=z,0}catch(V){if(typeof D>"u"||V.name!=="ErrnoError")throw V;return V.Ka}},m:function(e,n,o,u,c){n=Jt(n,o);try{if(isNaN(n))return 61;var y=J(e);return nr(y,n,u),G=[y.position>>>0,(q=y.position,1<=+Math.abs(q)?0<q?+Math.floor(q/4294967296)>>>0:~~+Math.ceil((q-+(~~q>>>0))/4294967296)>>>0:0)],k[c>>2]=G[0],k[c+4>>2]=G[1],y.hb&&n===0&&u===0&&(y.hb=null),0}catch(w){if(typeof D>"u"||w.name!=="ErrnoError")throw w;return w.Ka}},D:function(e){var o;try{var n=J(e);return(o=n.Ha)!=null&&o.fsync?n.Ha.fsync(n):0}catch(u){if(typeof D>"u"||u.name!=="ErrnoError")throw u;return u.Ka}},u:function(e,n,o,u){try{t:{var c=J(e);e=n;for(var y,w=n=0;w<o;w++){var I=F[e>>2],L=F[e+4>>2];e+=8;var O=ir(c,W,I,L,y);if(0>O){var z=-1;break t}n+=O,typeof y<"u"&&(y+=O)}z=n}return F[u>>2]=z,0}catch(V){if(typeof D>"u"||V.name!=="ErrnoError")throw V;return V.Ka}}},S=function(){var o;function e(u){var c;return S=u.exports,ue=S.I,qn(),ht=S.Aa,Nn.unshift(S.J),gt--,(c=l.monitorRunDependencies)==null||c.call(l,gt),gt==0&&Gt&&(u=Gt,Gt=null,u()),S}var n={a:Ri};if(gt++,(o=l.monitorRunDependencies)==null||o.call(l,gt),l.instantiateWasm)try{return l.instantiateWasm(n,e)}catch(u){return wt(`Module.instantiateWasm callback failed with error: ${u}`),!1}return wi(n,function(u){e(u.instance)}),{}}();l._sqlite3_free=e=>(l._sqlite3_free=S.K)(e),l._sqlite3_value_text=e=>(l._sqlite3_value_text=S.L)(e);var cr=()=>(cr=S.M)();l._sqlite3_prepare_v2=(e,n,o,u,c)=>(l._sqlite3_prepare_v2=S.N)(e,n,o,u,c),l._sqlite3_step=e=>(l._sqlite3_step=S.O)(e),l._sqlite3_finalize=e=>(l._sqlite3_finalize=S.P)(e),l._sqlite3_reset=e=>(l._sqlite3_reset=S.Q)(e),l._sqlite3_clear_bindings=e=>(l._sqlite3_clear_bindings=S.R)(e),l._sqlite3_value_blob=e=>(l._sqlite3_value_blob=S.S)(e),l._sqlite3_value_bytes=e=>(l._sqlite3_value_bytes=S.T)(e),l._sqlite3_value_double=e=>(l._sqlite3_value_double=S.U)(e),l._sqlite3_value_int=e=>(l._sqlite3_value_int=S.V)(e),l._sqlite3_value_type=e=>(l._sqlite3_value_type=S.W)(e),l._sqlite3_result_blob=(e,n,o,u)=>(l._sqlite3_result_blob=S.X)(e,n,o,u),l._sqlite3_result_double=(e,n)=>(l._sqlite3_result_double=S.Y)(e,n),l._sqlite3_result_error=(e,n,o)=>(l._sqlite3_result_error=S.Z)(e,n,o),l._sqlite3_result_int=(e,n)=>(l._sqlite3_result_int=S._)(e,n),l._sqlite3_result_int64=(e,n,o)=>(l._sqlite3_result_int64=S.$)(e,n,o),l._sqlite3_result_null=e=>(l._sqlite3_result_null=S.aa)(e),l._sqlite3_result_text=(e,n,o,u)=>(l._sqlite3_result_text=S.ba)(e,n,o,u),l._sqlite3_aggregate_context=(e,n)=>(l._sqlite3_aggregate_context=S.ca)(e,n),l._sqlite3_column_count=e=>(l._sqlite3_column_count=S.da)(e),l._sqlite3_data_count=e=>(l._sqlite3_data_count=S.ea)(e),l._sqlite3_column_blob=(e,n)=>(l._sqlite3_column_blob=S.fa)(e,n),l._sqlite3_column_bytes=(e,n)=>(l._sqlite3_column_bytes=S.ga)(e,n),l._sqlite3_column_double=(e,n)=>(l._sqlite3_column_double=S.ha)(e,n),l._sqlite3_column_text=(e,n)=>(l._sqlite3_column_text=S.ia)(e,n),l._sqlite3_column_type=(e,n)=>(l._sqlite3_column_type=S.ja)(e,n),l._sqlite3_column_name=(e,n)=>(l._sqlite3_column_name=S.ka)(e,n),l._sqlite3_bind_blob=(e,n,o,u,c)=>(l._sqlite3_bind_blob=S.la)(e,n,o,u,c),l._sqlite3_bind_double=(e,n,o)=>(l._sqlite3_bind_double=S.ma)(e,n,o),l._sqlite3_bind_int=(e,n,o)=>(l._sqlite3_bind_int=S.na)(e,n,o),l._sqlite3_bind_text=(e,n,o,u,c)=>(l._sqlite3_bind_text=S.oa)(e,n,o,u,c),l._sqlite3_bind_parameter_index=(e,n)=>(l._sqlite3_bind_parameter_index=S.pa)(e,n),l._sqlite3_sql=e=>(l._sqlite3_sql=S.qa)(e),l._sqlite3_normalized_sql=e=>(l._sqlite3_normalized_sql=S.ra)(e),l._sqlite3_errmsg=e=>(l._sqlite3_errmsg=S.sa)(e),l._sqlite3_exec=(e,n,o,u,c)=>(l._sqlite3_exec=S.ta)(e,n,o,u,c),l._sqlite3_changes=e=>(l._sqlite3_changes=S.ua)(e),l._sqlite3_close_v2=e=>(l._sqlite3_close_v2=S.va)(e),l._sqlite3_create_function_v2=(e,n,o,u,c,y,w,I,L)=>(l._sqlite3_create_function_v2=S.wa)(e,n,o,u,c,y,w,I,L),l._sqlite3_open=(e,n)=>(l._sqlite3_open=S.xa)(e,n);var be=l._malloc=e=>(be=l._malloc=S.ya)(e),xe=l._free=e=>(xe=l._free=S.za)(e);l._RegisterExtensionFunctions=e=>(l._RegisterExtensionFunctions=S.Ba)(e);var hr=(e,n)=>(hr=S.Ca)(e,n),Yt=()=>(Yt=S.Da)(),Kt=e=>(Kt=S.Ea)(e),yt=e=>(yt=S.Fa)(e);l.stackAlloc=yt,l.stackSave=Yt,l.stackRestore=Kt,l.cwrap=(e,n,o,u)=>{var c=!o||o.every(y=>y==="number"||y==="boolean");return n!=="string"&&c&&!u?l["_"+e]:function(){return Oi(e,n,o,arguments)}},l.addFunction=ge,l.removeFunction=Tt,l.UTF8ToString=Ue,l.ALLOC_NORMAL=ve,l.allocate=we,l.allocateUTF8OnStack=en;var Ee;Gt=function e(){Ee||dr(),Ee||(Gt=e)};function dr(){function e(){if(!Ee&&(Ee=!0,l.calledRun=!0,!Sn)){if(l.noFSInit||sr||(sr=!0,or(),l.stdin=l.stdin,l.stdout=l.stdout,l.stderr=l.stderr,l.stdin?Vt("stdin",l.stdin):Ke("/dev/tty","/dev/stdin"),l.stdout?Vt("stdout",null,l.stdout):Ke("/dev/tty","/dev/stdout"),l.stderr?Vt("stderr",null,l.stderr):Ke("/dev/tty1","/dev/stderr"),Pt("/dev/stdin",0),Pt("/dev/stdout",1),Pt("/dev/stderr",1)),zn=!1,ze(Nn),l.onRuntimeInitialized&&l.onRuntimeInitialized(),l.postRun)for(typeof l.postRun=="function"&&(l.postRun=[l.postRun]);l.postRun.length;){var n=l.postRun.shift();Mn.unshift(n)}ze(Mn)}}if(!(0<gt)){if(l.preRun)for(typeof l.preRun=="function"&&(l.preRun=[l.preRun]);l.preRun.length;)yi();ze(In),0<gt||(l.setStatus?(l.setStatus("Running..."),setTimeout(function(){setTimeout(function(){l.setStatus("")},1),e()},1)):e())}}if(l.preInit)for(typeof l.preInit=="function"&&(l.preInit=[l.preInit]);0<l.preInit.length;)l.preInit.pop()();return dr(),d}),i)};t.exports=s,t.exports.default=s})(Gr);var co=Gr.exports;const ho=ao(co),po="/GlobalBrain.jl/assets/sql-wasm-785JABKZ.wasm";function Oe(t){return Math.log2(1/t)}function mo(t){return t===1?0:t*Oe(t)+(1-t)*Oe(1-t)}function _o(t,r){return t===1&&r===1||t===0&&r===0?0:t*Oe(r)+(1-t)*Oe(1-r)}function Br(t,r){return _o(t,r)-mo(t)}async function yo(t,r,i,s){let a=await go(t,i,s),f=await bo(t,r,s),h=await Eo(t),d=await xo(t),p=await Ao(t);return{discussionTree:a,effects:f,scoreEvents:d,effectEvents:h,voteEvents:p}}function zr(t){const r=t.columns;return t.values.map(s=>r.reduce((a,f,h)=>(a[f]=s[h],a),{}))}async function vo(t,r){let i=t.prepare(`
		select distinct id
		from SimulationPost
		where simulation_id = :simulationId
		and parent_id is null
  `);i.bind({":simulationId":r});let s=[];for(;i.step();)s.push(i.getAsObject());return s}async function wo(t,r){let i=t.prepare(`
    SELECT simulation_id from Simulation where simulation_name = :simulationName
  `);i.bind({":simulationName":r});let s=[];for(;i.step();)s.push(i.getAsObject());return s[0].simulation_id}async function go(t,r,i){const s=t.prepare(`
    WITH postsWithActivity AS(
      select distinct(post_id) as id
      from voteEvent
      where vote_event_time <= :period
    ),
    currentPosts AS(
      SELECT SimulationPost.*
      FROM SimulationPost
      JOIN postsWithActivity using(id)
    )
    , currentScoreWithMax AS(
      SELECT MAX(vote_event_id), *
      FROM ScoreEvent
      WHERE vote_event_time <= :period
      GROUP BY post_id
    )
    , currentScore AS(
      SELECT
          vote_event_id
        , vote_event_time
        , post_id
        , o
        , o_count
        , o_size
        , p
        , score
      FROM currentScoreWithMax
    )
    , idsRecursive AS(
      SELECT *
      FROM currentPosts
      WHERE id = :root_post_id
      UNION ALL
      SELECT p2.*
      FROM currentPosts p2
      JOIN idsRecursive ON p2.parent_id = idsRecursive.id
    )
    SELECT
        idsRecursive.*
      , vote_event_id
      , vote_event_time
      , o
      , o_count
      , o_size
      , p
      , score
    FROM idsRecursive
    LEFT OUTER JOIN currentScore
    ON idsRecursive.id = currentScore.post_id
  `);s.bind({":root_post_id":r,":period":i});let a=[];for(;s.step();)a.push(s.getAsObject());return a}async function bo(t,r,i){let s=t.prepare(`
		select max(vote_event_id) as max_id, EffectEvent.*
		from EffectEvent
		join SimulationPost
		on EffectEvent.post_id = SimulationPost.id
		where simulation_id = :simulationId
		and vote_event_time <= :period
		group by EffectEvent.post_id, EffectEvent.comment_id
  `);s.bind({":simulationId":r,":period":i});let a=[];for(;s.step();)a.push(s.getAsObject());return a.map(h=>(h.magnitude=Br(h.p,h.q),h))}async function xo(t){let r=t.prepare("SELECT * FROM ScoreEvent"),i=[];for(;r.step();)i.push(r.getAsObject());return i}async function Eo(t){let r=t.prepare("SELECT * FROM EffectEvent"),i=[];for(;r.step();)i.push(r.getAsObject());return i.map(a=>(a.magnitude=Br(a.p,a.q),a))}async function Ao(t){let r=t.prepare("SELECT * FROM VoteEvent"),i=[];for(;r.step();)i.push(r.getAsObject());return i}function So(t){const r=Io(t.discussionTree),i=Mo(t.effects),s=ko(t.effectEvents),a=Ro(t.discussionTree,i),f=qo(r,a),h=No(t.voteEvents,r),d=Oo(r,s),p=Po(t.discussionTree,i);return{postsByPostId:f,voteEventsByPostId:h,effectsByPostIdCommentId:i,effectEventsByPostId:s,currentEffects:d,childrenIdsByPostId:a,childEffectsByPostId:p}}function qo(t,r){const s={...t[r[0][0]],x:el,y:nl},a={[s.id]:s};function f(h,d,p){let v={...t[h],x:d,y:p};if(a[h]=v,h in r){let _=0,b=0;r[h].length>1&&(_=Zu,b=_/(r[h].length-1)),r[h].forEach((E,T)=>{const N=d+T*b,C=p+tl;f(E,N,C)})}}return f(s.id,s.x,s.y),a}function Io(t){let r={};return t.forEach(i=>{r[i.id]=i}),r}function No(t,r){let i={};return t.forEach(s=>{let a=s.post_id;r[a]&&(a in i?i[a].push(s):i[a]=[s])}),i}function Mo(t){let r={};return t.forEach(i=>{r[`${i.post_id}-${i.comment_id}`]=i}),r}function ko(t){let r={};return t.forEach(i=>{let s=i.post_id;r[s]?r[s].push(i):r[s]=[i]}),r}function Oo(t,r){let i={};return Object.keys(t).forEach(a=>{a in r&&(i[a]=r[a].reduce(function(f,h){return f&&f.vote_event_id>h.vote_event_id?f:h}))}),i}function Ro(t,r){let i={};return t.forEach(s=>{let a=s.parent_id,f=a||0;f in i?(i[f].push(s.id),i[f].sort((h,d)=>{let p=r[`${a}-${h}`].magnitude;return r[`${a}-${d}`].magnitude-p})):i[f]=[s.id]}),i}function Po(t,r){let i={};return t.forEach(s=>{let a=s.parent_id;if(a!==null){let f=r[`${a}-${s.id}`];a in i?(i[a].push(f),i[a].sort((h,d)=>d.magnitude-h.magnitude)):i[a]=[f]}}),i}function To(t,r){let i;if(r===void 0)for(const s of t)s!=null&&(i<s||i===void 0&&s>=s)&&(i=s);else{let s=-1;for(let a of t)(a=r(a,++s,t))!=null&&(i<a||i===void 0&&a>=a)&&(i=a)}return i}function Lo(t,r){let i;if(r===void 0)for(const s of t)s!=null&&(i>s||i===void 0&&s>=s)&&(i=s);else{let s=-1;for(let a of t)(a=r(a,++s,t))!=null&&(i>a||i===void 0&&a>=a)&&(i=a)}return i}var Co={value:()=>{}};function Ur(){for(var t=0,r=arguments.length,i={},s;t<r;++t){if(!(s=arguments[t]+"")||s in i||/[\s.]/.test(s))throw new Error("illegal type: "+s);i[s]=[]}return new Ne(i)}function Ne(t){this._=t}function $o(t,r){return t.trim().split(/^|\s+/).map(function(i){var s="",a=i.indexOf(".");if(a>=0&&(s=i.slice(a+1),i=i.slice(0,a)),i&&!r.hasOwnProperty(i))throw new Error("unknown type: "+i);return{type:i,name:s}})}Ne.prototype=Ur.prototype={constructor:Ne,on:function(t,r){var i=this._,s=$o(t+"",i),a,f=-1,h=s.length;if(arguments.length<2){for(;++f<h;)if((a=(t=s[f]).type)&&(a=Ho(i[a],t.name)))return a;return}if(r!=null&&typeof r!="function")throw new Error("invalid callback: "+r);for(;++f<h;)if(a=(t=s[f]).type)i[a]=xr(i[a],t.name,r);else if(r==null)for(a in i)i[a]=xr(i[a],t.name,null);return this},copy:function(){var t={},r=this._;for(var i in r)t[i]=r[i].slice();return new Ne(t)},call:function(t,r){if((a=arguments.length-2)>0)for(var i=new Array(a),s=0,a,f;s<a;++s)i[s]=arguments[s+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(f=this._[t],s=0,a=f.length;s<a;++s)f[s].value.apply(r,i)},apply:function(t,r,i){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var s=this._[t],a=0,f=s.length;a<f;++a)s[a].value.apply(r,i)}};function Ho(t,r){for(var i=0,s=t.length,a;i<s;++i)if((a=t[i]).name===r)return a.value}function xr(t,r,i){for(var s=0,a=t.length;s<a;++s)if(t[s].name===r){t[s]=Co,t=t.slice(0,s).concat(t.slice(s+1));break}return i!=null&&t.push({name:r,value:i}),t}var cn="http://www.w3.org/1999/xhtml";const Er={svg:"http://www.w3.org/2000/svg",xhtml:cn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function He(t){var r=t+="",i=r.indexOf(":");return i>=0&&(r=t.slice(0,i))!=="xmlns"&&(t=t.slice(i+1)),Er.hasOwnProperty(r)?{space:Er[r],local:t}:t}function Do(t){return function(){var r=this.ownerDocument,i=this.namespaceURI;return i===cn&&r.documentElement.namespaceURI===cn?r.createElement(t):r.createElementNS(i,t)}}function Fo(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Wr(t){var r=He(t);return(r.local?Fo:Do)(r)}function Go(){}function vn(t){return t==null?Go:function(){return this.querySelector(t)}}function Bo(t){typeof t!="function"&&(t=vn(t));for(var r=this._groups,i=r.length,s=new Array(i),a=0;a<i;++a)for(var f=r[a],h=f.length,d=s[a]=new Array(h),p,l,v=0;v<h;++v)(p=f[v])&&(l=t.call(p,p.__data__,v,f))&&("__data__"in p&&(l.__data__=p.__data__),d[v]=l);return new j(s,this._parents)}function zo(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function Uo(){return[]}function Vr(t){return t==null?Uo:function(){return this.querySelectorAll(t)}}function Wo(t){return function(){return zo(t.apply(this,arguments))}}function Vo(t){typeof t=="function"?t=Wo(t):t=Vr(t);for(var r=this._groups,i=r.length,s=[],a=[],f=0;f<i;++f)for(var h=r[f],d=h.length,p,l=0;l<d;++l)(p=h[l])&&(s.push(t.call(p,p.__data__,l,h)),a.push(p));return new j(s,a)}function Xr(t){return function(){return this.matches(t)}}function Jr(t){return function(r){return r.matches(t)}}var Xo=Array.prototype.find;function Jo(t){return function(){return Xo.call(this.children,t)}}function Yo(){return this.firstElementChild}function Ko(t){return this.select(t==null?Yo:Jo(typeof t=="function"?t:Jr(t)))}var Qo=Array.prototype.filter;function jo(){return Array.from(this.children)}function Zo(t){return function(){return Qo.call(this.children,t)}}function ts(t){return this.selectAll(t==null?jo:Zo(typeof t=="function"?t:Jr(t)))}function es(t){typeof t!="function"&&(t=Xr(t));for(var r=this._groups,i=r.length,s=new Array(i),a=0;a<i;++a)for(var f=r[a],h=f.length,d=s[a]=[],p,l=0;l<h;++l)(p=f[l])&&t.call(p,p.__data__,l,f)&&d.push(p);return new j(s,this._parents)}function Yr(t){return new Array(t.length)}function ns(){return new j(this._enter||this._groups.map(Yr),this._parents)}function Re(t,r){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=r}Re.prototype={constructor:Re,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,r){return this._parent.insertBefore(t,r)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function rs(t){return function(){return t}}function is(t,r,i,s,a,f){for(var h=0,d,p=r.length,l=f.length;h<l;++h)(d=r[h])?(d.__data__=f[h],s[h]=d):i[h]=new Re(t,f[h]);for(;h<p;++h)(d=r[h])&&(a[h]=d)}function os(t,r,i,s,a,f,h){var d,p,l=new Map,v=r.length,_=f.length,b=new Array(v),E;for(d=0;d<v;++d)(p=r[d])&&(b[d]=E=h.call(p,p.__data__,d,r)+"",l.has(E)?a[d]=p:l.set(E,p));for(d=0;d<_;++d)E=h.call(t,f[d],d,f)+"",(p=l.get(E))?(s[d]=p,p.__data__=f[d],l.delete(E)):i[d]=new Re(t,f[d]);for(d=0;d<v;++d)(p=r[d])&&l.get(b[d])===p&&(a[d]=p)}function ss(t){return t.__data__}function as(t,r){if(!arguments.length)return Array.from(this,ss);var i=r?os:is,s=this._parents,a=this._groups;typeof t!="function"&&(t=rs(t));for(var f=a.length,h=new Array(f),d=new Array(f),p=new Array(f),l=0;l<f;++l){var v=s[l],_=a[l],b=_.length,E=us(t.call(v,v&&v.__data__,l,s)),T=E.length,N=d[l]=new Array(T),C=h[l]=new Array(T),mt=p[l]=new Array(b);i(v,_,N,C,mt,E,r);for(var U=0,X=0,Nt,Ht;U<T;++U)if(Nt=N[U]){for(U>=X&&(X=U+1);!(Ht=C[X])&&++X<T;);Nt._next=Ht||null}}return h=new j(h,s),h._enter=d,h._exit=p,h}function us(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function ls(){return new j(this._exit||this._groups.map(Yr),this._parents)}function fs(t,r,i){var s=this.enter(),a=this,f=this.exit();return typeof t=="function"?(s=t(s),s&&(s=s.selection())):s=s.append(t+""),r!=null&&(a=r(a),a&&(a=a.selection())),i==null?f.remove():i(f),s&&a?s.merge(a).order():a}function cs(t){for(var r=t.selection?t.selection():t,i=this._groups,s=r._groups,a=i.length,f=s.length,h=Math.min(a,f),d=new Array(a),p=0;p<h;++p)for(var l=i[p],v=s[p],_=l.length,b=d[p]=new Array(_),E,T=0;T<_;++T)(E=l[T]||v[T])&&(b[T]=E);for(;p<a;++p)d[p]=i[p];return new j(d,this._parents)}function hs(){for(var t=this._groups,r=-1,i=t.length;++r<i;)for(var s=t[r],a=s.length-1,f=s[a],h;--a>=0;)(h=s[a])&&(f&&h.compareDocumentPosition(f)^4&&f.parentNode.insertBefore(h,f),f=h);return this}function ds(t){t||(t=ps);function r(_,b){return _&&b?t(_.__data__,b.__data__):!_-!b}for(var i=this._groups,s=i.length,a=new Array(s),f=0;f<s;++f){for(var h=i[f],d=h.length,p=a[f]=new Array(d),l,v=0;v<d;++v)(l=h[v])&&(p[v]=l);p.sort(r)}return new j(a,this._parents).order()}function ps(t,r){return t<r?-1:t>r?1:t>=r?0:NaN}function ms(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function _s(){return Array.from(this)}function ys(){for(var t=this._groups,r=0,i=t.length;r<i;++r)for(var s=t[r],a=0,f=s.length;a<f;++a){var h=s[a];if(h)return h}return null}function vs(){let t=0;for(const r of this)++t;return t}function ws(){return!this.node()}function gs(t){for(var r=this._groups,i=0,s=r.length;i<s;++i)for(var a=r[i],f=0,h=a.length,d;f<h;++f)(d=a[f])&&t.call(d,d.__data__,f,a);return this}function bs(t){return function(){this.removeAttribute(t)}}function xs(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Es(t,r){return function(){this.setAttribute(t,r)}}function As(t,r){return function(){this.setAttributeNS(t.space,t.local,r)}}function Ss(t,r){return function(){var i=r.apply(this,arguments);i==null?this.removeAttribute(t):this.setAttribute(t,i)}}function qs(t,r){return function(){var i=r.apply(this,arguments);i==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,i)}}function Is(t,r){var i=He(t);if(arguments.length<2){var s=this.node();return i.local?s.getAttributeNS(i.space,i.local):s.getAttribute(i)}return this.each((r==null?i.local?xs:bs:typeof r=="function"?i.local?qs:Ss:i.local?As:Es)(i,r))}function Kr(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Ns(t){return function(){this.style.removeProperty(t)}}function Ms(t,r,i){return function(){this.style.setProperty(t,r,i)}}function ks(t,r,i){return function(){var s=r.apply(this,arguments);s==null?this.style.removeProperty(t):this.style.setProperty(t,s,i)}}function Os(t,r,i){return arguments.length>1?this.each((r==null?Ns:typeof r=="function"?ks:Ms)(t,r,i??"")):Ct(this.node(),t)}function Ct(t,r){return t.style.getPropertyValue(r)||Kr(t).getComputedStyle(t,null).getPropertyValue(r)}function Rs(t){return function(){delete this[t]}}function Ps(t,r){return function(){this[t]=r}}function Ts(t,r){return function(){var i=r.apply(this,arguments);i==null?delete this[t]:this[t]=i}}function Ls(t,r){return arguments.length>1?this.each((r==null?Rs:typeof r=="function"?Ts:Ps)(t,r)):this.node()[t]}function Qr(t){return t.trim().split(/^|\s+/)}function wn(t){return t.classList||new jr(t)}function jr(t){this._node=t,this._names=Qr(t.getAttribute("class")||"")}jr.prototype={add:function(t){var r=this._names.indexOf(t);r<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var r=this._names.indexOf(t);r>=0&&(this._names.splice(r,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Zr(t,r){for(var i=wn(t),s=-1,a=r.length;++s<a;)i.add(r[s])}function ti(t,r){for(var i=wn(t),s=-1,a=r.length;++s<a;)i.remove(r[s])}function Cs(t){return function(){Zr(this,t)}}function $s(t){return function(){ti(this,t)}}function Hs(t,r){return function(){(r.apply(this,arguments)?Zr:ti)(this,t)}}function Ds(t,r){var i=Qr(t+"");if(arguments.length<2){for(var s=wn(this.node()),a=-1,f=i.length;++a<f;)if(!s.contains(i[a]))return!1;return!0}return this.each((typeof r=="function"?Hs:r?Cs:$s)(i,r))}function Fs(){this.textContent=""}function Gs(t){return function(){this.textContent=t}}function Bs(t){return function(){var r=t.apply(this,arguments);this.textContent=r??""}}function zs(t){return arguments.length?this.each(t==null?Fs:(typeof t=="function"?Bs:Gs)(t)):this.node().textContent}function Us(){this.innerHTML=""}function Ws(t){return function(){this.innerHTML=t}}function Vs(t){return function(){var r=t.apply(this,arguments);this.innerHTML=r??""}}function Xs(t){return arguments.length?this.each(t==null?Us:(typeof t=="function"?Vs:Ws)(t)):this.node().innerHTML}function Js(){this.nextSibling&&this.parentNode.appendChild(this)}function Ys(){return this.each(Js)}function Ks(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Qs(){return this.each(Ks)}function js(t){var r=typeof t=="function"?t:Wr(t);return this.select(function(){return this.appendChild(r.apply(this,arguments))})}function Zs(){return null}function ta(t,r){var i=typeof t=="function"?t:Wr(t),s=r==null?Zs:typeof r=="function"?r:vn(r);return this.select(function(){return this.insertBefore(i.apply(this,arguments),s.apply(this,arguments)||null)})}function ea(){var t=this.parentNode;t&&t.removeChild(this)}function na(){return this.each(ea)}function ra(){var t=this.cloneNode(!1),r=this.parentNode;return r?r.insertBefore(t,this.nextSibling):t}function ia(){var t=this.cloneNode(!0),r=this.parentNode;return r?r.insertBefore(t,this.nextSibling):t}function oa(t){return this.select(t?ia:ra)}function sa(t){return arguments.length?this.property("__data__",t):this.node().__data__}function aa(t){return function(r){t.call(this,r,this.__data__)}}function ua(t){return t.trim().split(/^|\s+/).map(function(r){var i="",s=r.indexOf(".");return s>=0&&(i=r.slice(s+1),r=r.slice(0,s)),{type:r,name:i}})}function la(t){return function(){var r=this.__on;if(r){for(var i=0,s=-1,a=r.length,f;i<a;++i)f=r[i],(!t.type||f.type===t.type)&&f.name===t.name?this.removeEventListener(f.type,f.listener,f.options):r[++s]=f;++s?r.length=s:delete this.__on}}}function fa(t,r,i){return function(){var s=this.__on,a,f=aa(r);if(s){for(var h=0,d=s.length;h<d;++h)if((a=s[h]).type===t.type&&a.name===t.name){this.removeEventListener(a.type,a.listener,a.options),this.addEventListener(a.type,a.listener=f,a.options=i),a.value=r;return}}this.addEventListener(t.type,f,i),a={type:t.type,name:t.name,value:r,listener:f,options:i},s?s.push(a):this.__on=[a]}}function ca(t,r,i){var s=ua(t+""),a,f=s.length,h;if(arguments.length<2){var d=this.node().__on;if(d){for(var p=0,l=d.length,v;p<l;++p)for(a=0,v=d[p];a<f;++a)if((h=s[a]).type===v.type&&h.name===v.name)return v.value}return}for(d=r?fa:la,a=0;a<f;++a)this.each(d(s[a],r,i));return this}function ei(t,r,i){var s=Kr(t),a=s.CustomEvent;typeof a=="function"?a=new a(r,i):(a=s.document.createEvent("Event"),i?(a.initEvent(r,i.bubbles,i.cancelable),a.detail=i.detail):a.initEvent(r,!1,!1)),t.dispatchEvent(a)}function ha(t,r){return function(){return ei(this,t,r)}}function da(t,r){return function(){return ei(this,t,r.apply(this,arguments))}}function pa(t,r){return this.each((typeof r=="function"?da:ha)(t,r))}function*ma(){for(var t=this._groups,r=0,i=t.length;r<i;++r)for(var s=t[r],a=0,f=s.length,h;a<f;++a)(h=s[a])&&(yield h)}var ni=[null];function j(t,r){this._groups=t,this._parents=r}function se(){return new j([[document.documentElement]],ni)}function _a(){return this}j.prototype=se.prototype={constructor:j,select:Bo,selectAll:Vo,selectChild:Ko,selectChildren:ts,filter:es,data:as,enter:ns,exit:ls,join:fs,merge:cs,selection:_a,order:hs,sort:ds,call:ms,nodes:_s,node:ys,size:vs,empty:ws,each:gs,attr:Is,style:Os,property:Ls,classed:Ds,text:zs,html:Xs,raise:Ys,lower:Qs,append:js,insert:ta,remove:na,clone:oa,datum:sa,on:ca,dispatch:pa,[Symbol.iterator]:ma};function Ar(t){return typeof t=="string"?new j([[document.querySelector(t)]],[document.documentElement]):new j([[t]],ni)}function gn(t,r,i){t.prototype=r.prototype=i,i.constructor=t}function ri(t,r){var i=Object.create(t.prototype);for(var s in r)i[s]=r[s];return i}function ae(){}var ne=.7,Pe=1/ne,Lt="\\s*([+-]?\\d+)\\s*",re="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",at="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ya=/^#([0-9a-f]{3,8})$/,va=new RegExp(`^rgb\\(${Lt},${Lt},${Lt}\\)$`),wa=new RegExp(`^rgb\\(${at},${at},${at}\\)$`),ga=new RegExp(`^rgba\\(${Lt},${Lt},${Lt},${re}\\)$`),ba=new RegExp(`^rgba\\(${at},${at},${at},${re}\\)$`),xa=new RegExp(`^hsl\\(${re},${at},${at}\\)$`),Ea=new RegExp(`^hsla\\(${re},${at},${at},${re}\\)$`),Sr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};gn(ae,ie,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:qr,formatHex:qr,formatHex8:Aa,formatHsl:Sa,formatRgb:Ir,toString:Ir});function qr(){return this.rgb().formatHex()}function Aa(){return this.rgb().formatHex8()}function Sa(){return ii(this).formatHsl()}function Ir(){return this.rgb().formatRgb()}function ie(t){var r,i;return t=(t+"").trim().toLowerCase(),(r=ya.exec(t))?(i=r[1].length,r=parseInt(r[1],16),i===6?Nr(r):i===3?new K(r>>8&15|r>>4&240,r>>4&15|r&240,(r&15)<<4|r&15,1):i===8?Se(r>>24&255,r>>16&255,r>>8&255,(r&255)/255):i===4?Se(r>>12&15|r>>8&240,r>>8&15|r>>4&240,r>>4&15|r&240,((r&15)<<4|r&15)/255):null):(r=va.exec(t))?new K(r[1],r[2],r[3],1):(r=wa.exec(t))?new K(r[1]*255/100,r[2]*255/100,r[3]*255/100,1):(r=ga.exec(t))?Se(r[1],r[2],r[3],r[4]):(r=ba.exec(t))?Se(r[1]*255/100,r[2]*255/100,r[3]*255/100,r[4]):(r=xa.exec(t))?Or(r[1],r[2]/100,r[3]/100,1):(r=Ea.exec(t))?Or(r[1],r[2]/100,r[3]/100,r[4]):Sr.hasOwnProperty(t)?Nr(Sr[t]):t==="transparent"?new K(NaN,NaN,NaN,0):null}function Nr(t){return new K(t>>16&255,t>>8&255,t&255,1)}function Se(t,r,i,s){return s<=0&&(t=r=i=NaN),new K(t,r,i,s)}function qa(t){return t instanceof ae||(t=ie(t)),t?(t=t.rgb(),new K(t.r,t.g,t.b,t.opacity)):new K}function hn(t,r,i,s){return arguments.length===1?qa(t):new K(t,r,i,s??1)}function K(t,r,i,s){this.r=+t,this.g=+r,this.b=+i,this.opacity=+s}gn(K,hn,ri(ae,{brighter(t){return t=t==null?Pe:Math.pow(Pe,t),new K(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?ne:Math.pow(ne,t),new K(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new K(qt(this.r),qt(this.g),qt(this.b),Te(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Mr,formatHex:Mr,formatHex8:Ia,formatRgb:kr,toString:kr}));function Mr(){return`#${St(this.r)}${St(this.g)}${St(this.b)}`}function Ia(){return`#${St(this.r)}${St(this.g)}${St(this.b)}${St((isNaN(this.opacity)?1:this.opacity)*255)}`}function kr(){const t=Te(this.opacity);return`${t===1?"rgb(":"rgba("}${qt(this.r)}, ${qt(this.g)}, ${qt(this.b)}${t===1?")":`, ${t})`}`}function Te(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function qt(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function St(t){return t=qt(t),(t<16?"0":"")+t.toString(16)}function Or(t,r,i,s){return s<=0?t=r=i=NaN:i<=0||i>=1?t=r=NaN:r<=0&&(t=NaN),new it(t,r,i,s)}function ii(t){if(t instanceof it)return new it(t.h,t.s,t.l,t.opacity);if(t instanceof ae||(t=ie(t)),!t)return new it;if(t instanceof it)return t;t=t.rgb();var r=t.r/255,i=t.g/255,s=t.b/255,a=Math.min(r,i,s),f=Math.max(r,i,s),h=NaN,d=f-a,p=(f+a)/2;return d?(r===f?h=(i-s)/d+(i<s)*6:i===f?h=(s-r)/d+2:h=(r-i)/d+4,d/=p<.5?f+a:2-f-a,h*=60):d=p>0&&p<1?0:h,new it(h,d,p,t.opacity)}function Na(t,r,i,s){return arguments.length===1?ii(t):new it(t,r,i,s??1)}function it(t,r,i,s){this.h=+t,this.s=+r,this.l=+i,this.opacity=+s}gn(it,Na,ri(ae,{brighter(t){return t=t==null?Pe:Math.pow(Pe,t),new it(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?ne:Math.pow(ne,t),new it(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,r=isNaN(t)||isNaN(this.s)?0:this.s,i=this.l,s=i+(i<.5?i:1-i)*r,a=2*i-s;return new K(sn(t>=240?t-240:t+120,a,s),sn(t,a,s),sn(t<120?t+240:t-120,a,s),this.opacity)},clamp(){return new it(Rr(this.h),qe(this.s),qe(this.l),Te(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Te(this.opacity);return`${t===1?"hsl(":"hsla("}${Rr(this.h)}, ${qe(this.s)*100}%, ${qe(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Rr(t){return t=(t||0)%360,t<0?t+360:t}function qe(t){return Math.max(0,Math.min(1,t||0))}function sn(t,r,i){return(t<60?r+(i-r)*t/60:t<180?i:t<240?r+(i-r)*(240-t)/60:r)*255}const oi=t=>()=>t;function Ma(t,r){return function(i){return t+i*r}}function ka(t,r,i){return t=Math.pow(t,i),r=Math.pow(r,i)-t,i=1/i,function(s){return Math.pow(t+s*r,i)}}function Oa(t){return(t=+t)==1?si:function(r,i){return i-r?ka(r,i,t):oi(isNaN(r)?i:r)}}function si(t,r){var i=r-t;return i?Ma(t,i):oi(isNaN(t)?r:t)}const Pr=function t(r){var i=Oa(r);function s(a,f){var h=i((a=hn(a)).r,(f=hn(f)).r),d=i(a.g,f.g),p=i(a.b,f.b),l=si(a.opacity,f.opacity);return function(v){return a.r=h(v),a.g=d(v),a.b=p(v),a.opacity=l(v),a+""}}return s.gamma=t,s}(1);function vt(t,r){return t=+t,r=+r,function(i){return t*(1-i)+r*i}}var dn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,an=new RegExp(dn.source,"g");function Ra(t){return function(){return t}}function Pa(t){return function(r){return t(r)+""}}function Ta(t,r){var i=dn.lastIndex=an.lastIndex=0,s,a,f,h=-1,d=[],p=[];for(t=t+"",r=r+"";(s=dn.exec(t))&&(a=an.exec(r));)(f=a.index)>i&&(f=r.slice(i,f),d[h]?d[h]+=f:d[++h]=f),(s=s[0])===(a=a[0])?d[h]?d[h]+=a:d[++h]=a:(d[++h]=null,p.push({i:h,x:vt(s,a)})),i=an.lastIndex;return i<r.length&&(f=r.slice(i),d[h]?d[h]+=f:d[++h]=f),d.length<2?p[0]?Pa(p[0].x):Ra(r):(r=p.length,function(l){for(var v=0,_;v<r;++v)d[(_=p[v]).i]=_.x(l);return d.join("")})}var Tr=180/Math.PI,pn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ai(t,r,i,s,a,f){var h,d,p;return(h=Math.sqrt(t*t+r*r))&&(t/=h,r/=h),(p=t*i+r*s)&&(i-=t*p,s-=r*p),(d=Math.sqrt(i*i+s*s))&&(i/=d,s/=d,p/=d),t*s<r*i&&(t=-t,r=-r,p=-p,h=-h),{translateX:a,translateY:f,rotate:Math.atan2(r,t)*Tr,skewX:Math.atan(p)*Tr,scaleX:h,scaleY:d}}var Ie;function La(t){const r=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return r.isIdentity?pn:ai(r.a,r.b,r.c,r.d,r.e,r.f)}function Ca(t){return t==null||(Ie||(Ie=document.createElementNS("http://www.w3.org/2000/svg","g")),Ie.setAttribute("transform",t),!(t=Ie.transform.baseVal.consolidate()))?pn:(t=t.matrix,ai(t.a,t.b,t.c,t.d,t.e,t.f))}function ui(t,r,i,s){function a(l){return l.length?l.pop()+" ":""}function f(l,v,_,b,E,T){if(l!==_||v!==b){var N=E.push("translate(",null,r,null,i);T.push({i:N-4,x:vt(l,_)},{i:N-2,x:vt(v,b)})}else(_||b)&&E.push("translate("+_+r+b+i)}function h(l,v,_,b){l!==v?(l-v>180?v+=360:v-l>180&&(l+=360),b.push({i:_.push(a(_)+"rotate(",null,s)-2,x:vt(l,v)})):v&&_.push(a(_)+"rotate("+v+s)}function d(l,v,_,b){l!==v?b.push({i:_.push(a(_)+"skewX(",null,s)-2,x:vt(l,v)}):v&&_.push(a(_)+"skewX("+v+s)}function p(l,v,_,b,E,T){if(l!==_||v!==b){var N=E.push(a(E)+"scale(",null,",",null,")");T.push({i:N-4,x:vt(l,_)},{i:N-2,x:vt(v,b)})}else(_!==1||b!==1)&&E.push(a(E)+"scale("+_+","+b+")")}return function(l,v){var _=[],b=[];return l=t(l),v=t(v),f(l.translateX,l.translateY,v.translateX,v.translateY,_,b),h(l.rotate,v.rotate,_,b),d(l.skewX,v.skewX,_,b),p(l.scaleX,l.scaleY,v.scaleX,v.scaleY,_,b),l=v=null,function(E){for(var T=-1,N=b.length,C;++T<N;)_[(C=b[T]).i]=C.x(E);return _.join("")}}}var $a=ui(La,"px, ","px)","deg)"),Ha=ui(Ca,", ",")",")"),$t=0,Zt=0,Qt=0,li=1e3,Le,te,Ce=0,It=0,De=0,oe=typeof performance=="object"&&performance.now?performance:Date,fi=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function bn(){return It||(fi(Da),It=oe.now()+De)}function Da(){It=0}function $e(){this._call=this._time=this._next=null}$e.prototype=ci.prototype={constructor:$e,restart:function(t,r,i){if(typeof t!="function")throw new TypeError("callback is not a function");i=(i==null?bn():+i)+(r==null?0:+r),!this._next&&te!==this&&(te?te._next=this:Le=this,te=this),this._call=t,this._time=i,mn()},stop:function(){this._call&&(this._call=null,this._time=1/0,mn())}};function ci(t,r,i){var s=new $e;return s.restart(t,r,i),s}function Fa(){bn(),++$t;for(var t=Le,r;t;)(r=It-t._time)>=0&&t._call.call(void 0,r),t=t._next;--$t}function Lr(){It=(Ce=oe.now())+De,$t=Zt=0;try{Fa()}finally{$t=0,Ba(),It=0}}function Ga(){var t=oe.now(),r=t-Ce;r>li&&(De-=r,Ce=t)}function Ba(){for(var t,r=Le,i,s=1/0;r;)r._call?(s>r._time&&(s=r._time),t=r,r=r._next):(i=r._next,r._next=null,r=t?t._next=i:Le=i);te=t,mn(s)}function mn(t){if(!$t){Zt&&(Zt=clearTimeout(Zt));var r=t-It;r>24?(t<1/0&&(Zt=setTimeout(Lr,t-oe.now()-De)),Qt&&(Qt=clearInterval(Qt))):(Qt||(Ce=oe.now(),Qt=setInterval(Ga,li)),$t=1,fi(Lr))}}function Cr(t,r,i){var s=new $e;return r=r==null?0:+r,s.restart(a=>{s.stop(),t(a+r)},r,i),s}var za=Ur("start","end","cancel","interrupt"),Ua=[],hi=0,$r=1,_n=2,Me=3,Hr=4,yn=5,ke=6;function Fe(t,r,i,s,a,f){var h=t.__transition;if(!h)t.__transition={};else if(i in h)return;Wa(t,i,{name:r,index:s,group:a,on:za,tween:Ua,time:f.time,delay:f.delay,duration:f.duration,ease:f.ease,timer:null,state:hi})}function xn(t,r){var i=ot(t,r);if(i.state>hi)throw new Error("too late; already scheduled");return i}function ut(t,r){var i=ot(t,r);if(i.state>Me)throw new Error("too late; already running");return i}function ot(t,r){var i=t.__transition;if(!i||!(i=i[r]))throw new Error("transition not found");return i}function Wa(t,r,i){var s=t.__transition,a;s[r]=i,i.timer=ci(f,0,i.time);function f(l){i.state=$r,i.timer.restart(h,i.delay,i.time),i.delay<=l&&h(l-i.delay)}function h(l){var v,_,b,E;if(i.state!==$r)return p();for(v in s)if(E=s[v],E.name===i.name){if(E.state===Me)return Cr(h);E.state===Hr?(E.state=ke,E.timer.stop(),E.on.call("interrupt",t,t.__data__,E.index,E.group),delete s[v]):+v<r&&(E.state=ke,E.timer.stop(),E.on.call("cancel",t,t.__data__,E.index,E.group),delete s[v])}if(Cr(function(){i.state===Me&&(i.state=Hr,i.timer.restart(d,i.delay,i.time),d(l))}),i.state=_n,i.on.call("start",t,t.__data__,i.index,i.group),i.state===_n){for(i.state=Me,a=new Array(b=i.tween.length),v=0,_=-1;v<b;++v)(E=i.tween[v].value.call(t,t.__data__,i.index,i.group))&&(a[++_]=E);a.length=_+1}}function d(l){for(var v=l<i.duration?i.ease.call(null,l/i.duration):(i.timer.restart(p),i.state=yn,1),_=-1,b=a.length;++_<b;)a[_].call(t,v);i.state===yn&&(i.on.call("end",t,t.__data__,i.index,i.group),p())}function p(){i.state=ke,i.timer.stop(),delete s[r];for(var l in s)return;delete t.__transition}}function Va(t,r){var i=t.__transition,s,a,f=!0,h;if(i){r=r==null?null:r+"";for(h in i){if((s=i[h]).name!==r){f=!1;continue}a=s.state>_n&&s.state<yn,s.state=ke,s.timer.stop(),s.on.call(a?"interrupt":"cancel",t,t.__data__,s.index,s.group),delete i[h]}f&&delete t.__transition}}function Xa(t){return this.each(function(){Va(this,t)})}function Ja(t,r){var i,s;return function(){var a=ut(this,t),f=a.tween;if(f!==i){s=i=f;for(var h=0,d=s.length;h<d;++h)if(s[h].name===r){s=s.slice(),s.splice(h,1);break}}a.tween=s}}function Ya(t,r,i){var s,a;if(typeof i!="function")throw new Error;return function(){var f=ut(this,t),h=f.tween;if(h!==s){a=(s=h).slice();for(var d={name:r,value:i},p=0,l=a.length;p<l;++p)if(a[p].name===r){a[p]=d;break}p===l&&a.push(d)}f.tween=a}}function Ka(t,r){var i=this._id;if(t+="",arguments.length<2){for(var s=ot(this.node(),i).tween,a=0,f=s.length,h;a<f;++a)if((h=s[a]).name===t)return h.value;return null}return this.each((r==null?Ja:Ya)(i,t,r))}function En(t,r,i){var s=t._id;return t.each(function(){var a=ut(this,s);(a.value||(a.value={}))[r]=i.apply(this,arguments)}),function(a){return ot(a,s).value[r]}}function di(t,r){var i;return(typeof r=="number"?vt:r instanceof ie?Pr:(i=ie(r))?(r=i,Pr):Ta)(t,r)}function Qa(t){return function(){this.removeAttribute(t)}}function ja(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Za(t,r,i){var s,a=i+"",f;return function(){var h=this.getAttribute(t);return h===a?null:h===s?f:f=r(s=h,i)}}function tu(t,r,i){var s,a=i+"",f;return function(){var h=this.getAttributeNS(t.space,t.local);return h===a?null:h===s?f:f=r(s=h,i)}}function eu(t,r,i){var s,a,f;return function(){var h,d=i(this),p;return d==null?void this.removeAttribute(t):(h=this.getAttribute(t),p=d+"",h===p?null:h===s&&p===a?f:(a=p,f=r(s=h,d)))}}function nu(t,r,i){var s,a,f;return function(){var h,d=i(this),p;return d==null?void this.removeAttributeNS(t.space,t.local):(h=this.getAttributeNS(t.space,t.local),p=d+"",h===p?null:h===s&&p===a?f:(a=p,f=r(s=h,d)))}}function ru(t,r){var i=He(t),s=i==="transform"?Ha:di;return this.attrTween(t,typeof r=="function"?(i.local?nu:eu)(i,s,En(this,"attr."+t,r)):r==null?(i.local?ja:Qa)(i):(i.local?tu:Za)(i,s,r))}function iu(t,r){return function(i){this.setAttribute(t,r.call(this,i))}}function ou(t,r){return function(i){this.setAttributeNS(t.space,t.local,r.call(this,i))}}function su(t,r){var i,s;function a(){var f=r.apply(this,arguments);return f!==s&&(i=(s=f)&&ou(t,f)),i}return a._value=r,a}function au(t,r){var i,s;function a(){var f=r.apply(this,arguments);return f!==s&&(i=(s=f)&&iu(t,f)),i}return a._value=r,a}function uu(t,r){var i="attr."+t;if(arguments.length<2)return(i=this.tween(i))&&i._value;if(r==null)return this.tween(i,null);if(typeof r!="function")throw new Error;var s=He(t);return this.tween(i,(s.local?su:au)(s,r))}function lu(t,r){return function(){xn(this,t).delay=+r.apply(this,arguments)}}function fu(t,r){return r=+r,function(){xn(this,t).delay=r}}function cu(t){var r=this._id;return arguments.length?this.each((typeof t=="function"?lu:fu)(r,t)):ot(this.node(),r).delay}function hu(t,r){return function(){ut(this,t).duration=+r.apply(this,arguments)}}function du(t,r){return r=+r,function(){ut(this,t).duration=r}}function pu(t){var r=this._id;return arguments.length?this.each((typeof t=="function"?hu:du)(r,t)):ot(this.node(),r).duration}function mu(t,r){if(typeof r!="function")throw new Error;return function(){ut(this,t).ease=r}}function _u(t){var r=this._id;return arguments.length?this.each(mu(r,t)):ot(this.node(),r).ease}function yu(t,r){return function(){var i=r.apply(this,arguments);if(typeof i!="function")throw new Error;ut(this,t).ease=i}}function vu(t){if(typeof t!="function")throw new Error;return this.each(yu(this._id,t))}function wu(t){typeof t!="function"&&(t=Xr(t));for(var r=this._groups,i=r.length,s=new Array(i),a=0;a<i;++a)for(var f=r[a],h=f.length,d=s[a]=[],p,l=0;l<h;++l)(p=f[l])&&t.call(p,p.__data__,l,f)&&d.push(p);return new pt(s,this._parents,this._name,this._id)}function gu(t){if(t._id!==this._id)throw new Error;for(var r=this._groups,i=t._groups,s=r.length,a=i.length,f=Math.min(s,a),h=new Array(s),d=0;d<f;++d)for(var p=r[d],l=i[d],v=p.length,_=h[d]=new Array(v),b,E=0;E<v;++E)(b=p[E]||l[E])&&(_[E]=b);for(;d<s;++d)h[d]=r[d];return new pt(h,this._parents,this._name,this._id)}function bu(t){return(t+"").trim().split(/^|\s+/).every(function(r){var i=r.indexOf(".");return i>=0&&(r=r.slice(0,i)),!r||r==="start"})}function xu(t,r,i){var s,a,f=bu(r)?xn:ut;return function(){var h=f(this,t),d=h.on;d!==s&&(a=(s=d).copy()).on(r,i),h.on=a}}function Eu(t,r){var i=this._id;return arguments.length<2?ot(this.node(),i).on.on(t):this.each(xu(i,t,r))}function Au(t){return function(){var r=this.parentNode;for(var i in this.__transition)if(+i!==t)return;r&&r.removeChild(this)}}function Su(){return this.on("end.remove",Au(this._id))}function qu(t){var r=this._name,i=this._id;typeof t!="function"&&(t=vn(t));for(var s=this._groups,a=s.length,f=new Array(a),h=0;h<a;++h)for(var d=s[h],p=d.length,l=f[h]=new Array(p),v,_,b=0;b<p;++b)(v=d[b])&&(_=t.call(v,v.__data__,b,d))&&("__data__"in v&&(_.__data__=v.__data__),l[b]=_,Fe(l[b],r,i,b,l,ot(v,i)));return new pt(f,this._parents,r,i)}function Iu(t){var r=this._name,i=this._id;typeof t!="function"&&(t=Vr(t));for(var s=this._groups,a=s.length,f=[],h=[],d=0;d<a;++d)for(var p=s[d],l=p.length,v,_=0;_<l;++_)if(v=p[_]){for(var b=t.call(v,v.__data__,_,p),E,T=ot(v,i),N=0,C=b.length;N<C;++N)(E=b[N])&&Fe(E,r,i,N,b,T);f.push(b),h.push(v)}return new pt(f,h,r,i)}var Nu=se.prototype.constructor;function Mu(){return new Nu(this._groups,this._parents)}function ku(t,r){var i,s,a;return function(){var f=Ct(this,t),h=(this.style.removeProperty(t),Ct(this,t));return f===h?null:f===i&&h===s?a:a=r(i=f,s=h)}}function pi(t){return function(){this.style.removeProperty(t)}}function Ou(t,r,i){var s,a=i+"",f;return function(){var h=Ct(this,t);return h===a?null:h===s?f:f=r(s=h,i)}}function Ru(t,r,i){var s,a,f;return function(){var h=Ct(this,t),d=i(this),p=d+"";return d==null&&(p=d=(this.style.removeProperty(t),Ct(this,t))),h===p?null:h===s&&p===a?f:(a=p,f=r(s=h,d))}}function Pu(t,r){var i,s,a,f="style."+r,h="end."+f,d;return function(){var p=ut(this,t),l=p.on,v=p.value[f]==null?d||(d=pi(r)):void 0;(l!==i||a!==v)&&(s=(i=l).copy()).on(h,a=v),p.on=s}}function Tu(t,r,i){var s=(t+="")=="transform"?$a:di;return r==null?this.styleTween(t,ku(t,s)).on("end.style."+t,pi(t)):typeof r=="function"?this.styleTween(t,Ru(t,s,En(this,"style."+t,r))).each(Pu(this._id,t)):this.styleTween(t,Ou(t,s,r),i).on("end.style."+t,null)}function Lu(t,r,i){return function(s){this.style.setProperty(t,r.call(this,s),i)}}function Cu(t,r,i){var s,a;function f(){var h=r.apply(this,arguments);return h!==a&&(s=(a=h)&&Lu(t,h,i)),s}return f._value=r,f}function $u(t,r,i){var s="style."+(t+="");if(arguments.length<2)return(s=this.tween(s))&&s._value;if(r==null)return this.tween(s,null);if(typeof r!="function")throw new Error;return this.tween(s,Cu(t,r,i??""))}function Hu(t){return function(){this.textContent=t}}function Du(t){return function(){var r=t(this);this.textContent=r??""}}function Fu(t){return this.tween("text",typeof t=="function"?Du(En(this,"text",t)):Hu(t==null?"":t+""))}function Gu(t){return function(r){this.textContent=t.call(this,r)}}function Bu(t){var r,i;function s(){var a=t.apply(this,arguments);return a!==i&&(r=(i=a)&&Gu(a)),r}return s._value=t,s}function zu(t){var r="text";if(arguments.length<1)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,Bu(t))}function Uu(){for(var t=this._name,r=this._id,i=mi(),s=this._groups,a=s.length,f=0;f<a;++f)for(var h=s[f],d=h.length,p,l=0;l<d;++l)if(p=h[l]){var v=ot(p,r);Fe(p,t,i,l,h,{time:v.time+v.delay+v.duration,delay:0,duration:v.duration,ease:v.ease})}return new pt(s,this._parents,t,i)}function Wu(){var t,r,i=this,s=i._id,a=i.size();return new Promise(function(f,h){var d={value:h},p={value:function(){--a===0&&f()}};i.each(function(){var l=ut(this,s),v=l.on;v!==t&&(r=(t=v).copy(),r._.cancel.push(d),r._.interrupt.push(d),r._.end.push(p)),l.on=r}),a===0&&f()})}var Vu=0;function pt(t,r,i,s){this._groups=t,this._parents=r,this._name=i,this._id=s}function mi(){return++Vu}var dt=se.prototype;pt.prototype={constructor:pt,select:qu,selectAll:Iu,selectChild:dt.selectChild,selectChildren:dt.selectChildren,filter:wu,merge:gu,selection:Mu,transition:Uu,call:dt.call,nodes:dt.nodes,node:dt.node,size:dt.size,empty:dt.empty,each:dt.each,on:Eu,attr:ru,attrTween:uu,style:Tu,styleTween:$u,text:Fu,textTween:zu,remove:Su,tween:Ka,delay:cu,duration:pu,ease:_u,easeVarying:vu,end:Wu,[Symbol.iterator]:dt[Symbol.iterator]};function Xu(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var Ju={time:null,delay:0,duration:250,ease:Xu};function Yu(t,r){for(var i;!(i=t.__transition)||!(i=i[r]);)if(!(t=t.parentNode))throw new Error(`transition ${r} not found`);return i}function Ku(t){var r,i;t instanceof pt?(r=t._id,t=t._name):(r=mi(),(i=Ju).time=bn(),t=t==null?null:t+"");for(var s=this._groups,a=s.length,f=0;f<a;++f)for(var h=s[f],d=h.length,p,l=0;l<d;++l)(p=h[l])&&Fe(p,t,r,l,h,i||Yu(p,r));return new pt(s,this._parents,t,r)}se.prototype.interrupt=Xa;se.prototype.transition=Ku;function ee(t,r,i){this.k=t,this.x=r,this.y=i}ee.prototype={constructor:ee,scale:function(t){return t===1?this:new ee(this.k*t,this.x,this.y)},translate:function(t,r){return t===0&r===0?this:new ee(this.k,this.x+this.k*t,this.y+this.k*r)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};ee.prototype;const Qu=1600,ju=1600,Zu=400,tl=150,el=100,nl=30,jt=250,et=65,un=20,rl="0,10 10,10 5,0",il="0,0 10,0 5,10";async function ln(t,r){let i=r.simulationName,s=await wo(t,i),a=r.period,h=(await vo(t,s))[0].id,d=await yo(t,s,h,a),p=So(d),l=p.postsByPostId[p.childrenIdsByPostId[0][0]];Ar("div#tree-chart svg").remove();const v=Ar("div#tree-chart").append("svg").attr("width",Qu).attr("height",ju);v.html(""),await sl(v,d,p);let _=d.scoreEvents.filter(E=>E.post_id===l.id);function b(E){const T=_[E];if(T===void 0)return;const N=T.vote_event_time,C=document.getElementById("period");C.value!=N&&(C.value=N,C.dispatchEvent(new Event("change")))}await al(d,p,l.id,b)}function ol(t,r){let i=Lo(r.voteEventsByPostId[t],p=>p.vote_event_id),s=To(r.voteEventsByPostId[t],p=>p.vote_event_id),a=Math.floor(s/10)*10,f=Math.floor(i/10)*10,h=Math.floor((a+un-f)/un);const d=[...Array(h).keys()].map(p=>p*un+f);return[i,s,d]}async function sl(t,r,i){let s=r.discussionTree.filter(_=>_.parent_id!==null).map(_=>({parent:i.postsByPostId[_.parent_id],post:i.postsByPostId[_.id],edgeData:i.effectsByPostIdCommentId[`${_.parent_id}-${_.id}`]}));t.append("g").selectAll("g").data(s,_=>{var b;return((b=_.parent)==null?void 0:b.id)+"-"+_.post.id}).join("g").attr("id",_=>{var b;return"edgeGroup"+((b=_.parent)==null?void 0:b.id)+"-"+_.post.id}).append("line").attr("x1",_=>{var b;return((b=_.parent)==null?void 0:b.x)+jt/2}).attr("y1",_=>{var b;return((b=_.parent)==null?void 0:b.y)+et}).attr("x2",_=>_.post.x+jt/2).attr("y2",_=>_.post.y).attr("stroke-width",_=>{let b=10;return 1+Math.min(b,_.edgeData.magnitude)/b*10}).attr("stroke",_=>_.edgeData.p>_.edgeData.q?"forestgreen":"tomato").style("stroke-linecap","round");let d=t.append("g").selectAll("g").data(r.discussionTree.map(_=>i.postsByPostId[_.id]),_=>_.id).join("g").attr("id",_=>"nodeGroup"+_.id).attr("transform",_=>`translate(${_.x}, ${_.y})`);d.append("rect").attr("x",0).attr("y",0).attr("width",jt).attr("height",et).attr("stroke","black"),d.append("foreignObject").attr("x",0).attr("y",0).attr("width",jt).attr("height",et).append("xhtml:div").style("width",`${jt}px`).style("height",`${et}px`).style("overflow","auto").style("box-sizing","border-box").style("padding","5px").style("font-size","12px").classed("post-content",!0).html(_=>_.content);function p(_){let b=10,E=["k","m","b","t"],T=_.toString();for(let N=E.length-1;N>=0;N--){let C=Math.pow(10,(N+1)*3);if(C<=_){_=Math.round(_*b/C)/b,_==1e3&&N<E.length-1&&(_=1,N++),T=_+E[N];break}}return T}function l(_,b,E,T){let N=_.append("g");N.append("rect").attr("width",25).attr("height",et).attr("x",b).attr("y",0).attr("opacity",.05).style("fill","transparent").attr("stroke","black").attr("display","inline"),N.append("rect").attr("width",25).attr("height",C=>T(C)*et).attr("x",b).attr("y",C=>et-T(C)*et).style("fill",E).attr("display","inline")}let v=d.append("g");v.append("g").attr("transform",`translate(-20, ${et/2-15})`).append("polygon").attr("points",rl).attr("opacity",_=>_.o_count/_.o_size),v.append("g").attr("transform",`translate(-20, ${et/2+5})`).append("polygon").attr("points",il).attr("opacity",_=>(_.o_size-_.o_count)/_.o_size),v.append("text").text(_=>p(_.o_count)).attr("width",10).attr("x",-15).attr("y",et/2-20).attr("font-size","12px").attr("text-anchor","middle"),v.append("text").text(_=>_.o_size-_.o_count>0?p(_.o_size-_.o_count):"").attr("width",10).attr("x",-15).attr("y",et/2+30).attr("font-size","12px").attr("text-anchor","middle"),l(v,-55,"black",_=>_.o_count/_.o_size==0?.05:_.o_count/_.o_size),l(v,-85,"steelblue",_=>_.p)}async function al(t,r,i,s){let a=t.scoreEvents.filter(U=>U.post_id===i),[f,h,d]=ol(i,r),p=a.map((U,X)=>[U.vote_event_id,U.o,U.p,void 0]);var l=0;let v=0;for(var _=0;_<a.length;_++){const X=a[_].vote_event_time;X!==l&&(v+=1,p[_][3]="Period "+v,l=X)}var b=document.getElementById("line-chart"),E=new google.visualization.DataTable;E.addColumn("number","Time"),E.addColumn("number","overall"),E.addColumn("number","informed"),E.addColumn({type:"string",role:"annotation"}),E.addRows(p);var T={backgroundColor:{fill:"transparent"},dataOpacity:.85,hAxis:{title:"Time",logScale:!1,ticks:d},vAxis:{title:"Probability",logScale:!1,ticks:[0,.25,.5,.75,1]},lineWidth:2,colors:["black","lightblue","#AF7FDF","#6FAEAE","green","pink"],chartArea:{left:40,top:10,bottom:40,right:40,width:"95%"},height:160,legend:{position:"bottom"},crosshair:{trigger:"both"},displayAnnotations:!0,annotations:{boxStyle:{},stem:{color:"black",length:30},textStyle:{color:"brown",fontSize:11,bold:!0},alwaysOutside:!0}},N=new google.visualization.LineChart(b);function C(U){}function mt(U){var X=N.getSelection()[0];X!==void 0&&s(X.row)}google.visualization.events.addListener(N,"select",mt),google.visualization.events.addListener(N,"onmouseover",C),N.draw(E,T)}function fn(){const r=new URLSearchParams(window.location.search).get("simulationName"),i=document.getElementById("controlForm"),s=new FormData(i),a=s.get("period")?parseInt(s.get("period")):1;return{simulationName:r,period:a}}function ul(t){ll(t);const r=document.getElementById("simulationName"),i=_i();return r.value=i,Dr(i),r.addEventListener("change",s=>{const a=s.target.value;Dr(a)}),i}function ll(t){const r=document.getElementById("simulationName");r.innerHTML="",t.forEach((i,s)=>{const a=document.createElement("option");a.value=i,a.text=i,s===0&&(a.selected=!0),r==null||r.appendChild(a)})}function _i(){const t=document.getElementById("simulationName");return fl()||t.value}function fl(){return new URLSearchParams(window.location.search).get("simulationName")}function Dr(t){const r=new URL(window.location.href);r.searchParams.set("simulationName",t),window.history.replaceState({},"",r.toString())}function Fr(t,r){const i=t.exec(`
    select step, description
    from Period
    join Simulation on (Simulation.simulation_id = Period.simulation_id)
    where simulation_name = :simulationName 
    `,{":simulationName":r}),s=zr(i[0]),a=document.getElementById("period"),f=document.getElementById("periods");f.innerHTML="",s.forEach((h,d)=>{if(h.description!==null){const p=document.createElement("li");p.innerHTML="<strong>Period "+(d+1)+"</strong>: "+h.description,p.dataset.step=h.step,p.className="period",f==null||f.appendChild(p),p.addEventListener("mouseenter",l=>{a.value!=h.step&&(a.value=h.step,a.dispatchEvent(new Event("change")))}),p.addEventListener("mouseleave",l=>{a.selectedIndex=a.options.length-1,a.dispatchEvent(new Event("change"))})}})}async function An(){const t=ho({locateFile:()=>po}),r=fetch(so).then(l=>l.arrayBuffer()),[i,s]=await Promise.all([t,r]),a=new i.Database(new Uint8Array(s)),f=a.exec("select simulation_id, simulation_name from simulation"),d=zr(f[0]).map(l=>({simulationId:l.simulation_id,simulationName:l.simulation_name})).map(l=>l.simulationName),p=ul(d);Fr(a,p),document.getElementById("period").addEventListener("change",function(){ln(a,fn())}),document.getElementById("simulationName").addEventListener("change",function(){const l=_i();Fr(a,l),ln(a,fn())}),ln(a,fn())}google.charts.load("current",{packages:["corechart","line"]});google.charts.setOnLoadCallback(An);window.addEventListener("resize",An,!1);An();
